<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Hexo">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Hexo">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/"/>





  <title>Hexo</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Hexo</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Startseite
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archiv
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/01/02/JavaScriptTwenty3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/02/JavaScriptTwenty3/" itemprop="url">Web前端的知识之旅哟—— JavaScript终章</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-01-02T17:56:10+08:00">
                2018-01-02
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>感觉js部分应该没什么要介绍的了，所以打算这一篇介绍一些零碎的东西。</p>
<p>• <strong><span style="color: #ff0000;">DOCTYPE三种标准模式的写法</span></strong></p>
<p>1.<strong><span style="color: #ff0000;">&lt;!DOCTYPE html&gt;</span></strong></p>
<p>2.&lt;!DOCTYPE HTML PUBLIC “-//W3C//DTD HTML 4.01//EN” “<a href="http://www.w3.org/TR/html4/strict.dtd”&amp;gt" target="_blank" rel="noopener">http://www.w3.org/TR/html4/strict.dtd”&amp;gt</a>;</p>
<p>3.&lt;!DOCTYPE html PUBLIC “-//W3C//DTD XHTML 1.0 Strict//EN” “<a href="http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd”&amp;gt" target="_blank" rel="noopener">http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd”&amp;gt</a>;</p>
<p>当还是XHTML的时候一般用第三种，但是现在我们一般直接用第一种写法就可以了，第一种是HTML5规范的标准写法。</p>
<p>• <strong><span style="color: #ff0000;">label标签</span></strong></p>
<p>label标签的作用主要是用来<span style="color: #ff0000;">绑定</span>的，它里面有一个<strong><span style="color: #ff0000;">for属性</span></strong>。</p>
<p>通过for属性，里面写上要绑定的标签的id，就可以把这个label标签绑定到相对应的标签上了。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-HTML prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="tag">&lt;label</span><span class="pln"> </span><span class="atn">for</span><span class="pun">=</span><span class="atv">“demo”</span><span class="tag">&gt;</span><span class="pln">username:</span><span class="tag">&lt;/label&gt;</span><br>3.  <span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">“text”</span><span class="pln"> </span><span class="atn">id</span><span class="pun">=</span><span class="atv">“demo”</span><span class="pln"> </span><span class="tag">/&gt;</span></pre><div class="code-pretty-toolbar"><span class="title">HTML</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>现在我们点击username这个label标签，也可以触发input的聚焦事件，就好像这两个是一个东西一样，可以提高用户体验。</p>
<p>另外，我们如果在js代码中要表示label标签的for属性的话，要写<span style="color: #ff0000;">htmlFor</span>，而不能直接写for。</p>
<p>• <strong><span style="color: #ff0000;">属性映射</span></strong></p>
<p>这里的映射是指标签的行间属性（特性）和DOM对象的属性之间的映射关系。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">“demo”</span><span class="pln"> </span><span class="atn">id</span><span class="pun">=</span><span class="atv">“only”</span><span class="pln"> </span><span class="atn">data-log</span><span class="pun">=</span><span class="atv">“123”</span><span class="pln"> </span><span class="atn">abc</span><span class="pun">=</span><span class="atv">“a”</span><span class="tag">&gt;&lt;/div&gt;</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>class和id属性是系统自带的，后两个属性是我们自己写的属性。</p>
<p>而我们获取出来的DOM对象div，可以通过div.className和div.id的方式来改写行间的属性值，但是却没法通过div.data-log或者div.abc来改写行间属性。</p>
<p>这是因为系统默认的属性之间是有一种映射关系的，我们可以直接修改DOM的属性来修改行间属性，但是对于我们自己设置的属性，就只能通过<span style="color: #ff0000;">setAttribute</span>和<span style="color: #ff0000;">getAttribute</span>来设置和获取了。</p>
<p>js引擎特殊赋予的映射关系有：class、id、style、value等属性。</p>
<p><span style="color: #ff0000;"><strong>&nbsp;<span style="color: #000000;">•</span> img图片预加载</strong></span></p>
<p>其实图片预加载是一种<span style="color: #ff0000;">思想</span>，而不是一种代码方式。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">var</span><span class="pln"> count </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><br>3.  <span class="pln">    img</span><span class="pun">;</span><br>4.  <span class="kwd">var</span><span class="pln"> timer </span><span class="pun">=</span><span class="pln"> setInterval</span><span class="pun">(</span><span class="kwd">function</span><span class="pln"> </span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><br>5.  <span class="pln">    count</span><span class="pun">++;</span><br>6.  <span class="pln">    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">count </span><span class="pun">==</span><span class="pln"> </span><span class="lit">5</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>7.  <span class="pln">        img </span><span class="pun">=</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">createElement</span><span class="pun">(</span><span class="str">‘img’</span><span class="pun">);</span><br>8.  <span class="pln">        img</span><span class="pun">.</span><span class="pln">src</span><span class="pun">=</span><span class="str">‘xxx’</span><span class="pun">;</span><br>9.  <span class="pln">        document</span><span class="pun">.</span><span class="pln">body</span><span class="pun">.</span><span class="pln">appendChild</span><span class="pun">(</span><span class="pln">img</span><span class="pun">);</span><br>10.  <span class="pln">        clearInterval</span><span class="pun">(</span><span class="pln">timer</span><span class="pun">);</span><br>11.  <span class="pln">    </span><span class="pun">}</span><br>12.  <span class="pun">},</span><span class="pln"> </span><span class="lit">1000</span><span class="pun">);</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>如果我们加入的图片很大的话，展示出来的效果将是一点一点的往下加载，导致很久图片整体才会显现出来。因此，我们为了让图片显示出来的时候就是整体，只需要让图片的src提前下载，等到需要展示的时候直接加入进来就可以。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">var</span><span class="pln"> count </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><br>3.  <span class="pln">    img </span><span class="pun">=</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">createElement</span><span class="pun">(</span><span class="str">‘img’</span><span class="pun">);</span><br>4.  <span class="pln">img</span><span class="pun">.</span><span class="pln">src</span><span class="pun">=</span><span class="str">‘xxx’</span><span class="pun">;</span><br>5.  <span class="kwd">var</span><span class="pln"> timer </span><span class="pun">=</span><span class="pln"> setInterval</span><span class="pun">(</span><span class="kwd">function</span><span class="pln"> </span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><br>6.  <span class="pln">    count</span><span class="pun">++;</span><br>7.  <span class="pln">    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">count </span><span class="pun">==</span><span class="pln"> </span><span class="lit">5</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>8.  <span class="pln">        document</span><span class="pun">.</span><span class="pln">body</span><span class="pun">.</span><span class="pln">appendChild</span><span class="pun">(</span><span class="pln">img</span><span class="pun">);</span><br>9.  <span class="pln">        clearInterval</span><span class="pun">(</span><span class="pln">timer</span><span class="pun">);</span><br>10.  <span class="pln">    </span><span class="pun">}</span><br>11.  <span class="pun">},</span><span class="pln"> </span><span class="lit">1000</span><span class="pun">);</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>但是凡事优化就会有利有弊，这种方式的<span style="color: #ff0000;">弊端就在于前期会很占用网速</span>。</p>
<p>• <strong><span style="color: #ff0000;">模拟提取类名</span></strong></p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="pln">    </span><span class="typ">Document</span><span class="pun">.</span><span class="pln">prototype</span><span class="pun">.</span><span class="pln">getClassName </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">className</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>3.  <span class="pln">        </span><span class="com">// 获取出来所有的元素</span><br>4.  <span class="pln">        </span><span class="kwd">var</span><span class="pln"> allEle </span><span class="pun">=</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">getElementsByTagName</span><span class="pun">(</span><span class="str">‘*’</span><span class="pun">),</span><span class="pln">    </span><br>5.  <span class="pln">            retArr </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[];</span><br>6.  <span class="pln">        </span><span class="com">// 遍历每一个元素</span><br>7.  <span class="pln">        </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">var</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> len </span><span class="pun">=</span><span class="pln"> allEle</span><span class="pun">.</span><span class="pln">length</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> len</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><br>8.  <span class="pln">            </span><span class="com">// 把这个元素的所有类名都提取出来</span><br>9.  <span class="pln">            </span><span class="kwd">var</span><span class="pln"> classNameArr </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[];</span><br>10.  <span class="pln">            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">allEle</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">className</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>11.  <span class="pln">                classNameArr </span><span class="pun">=</span><span class="pln"> allEle</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">className</span><span class="pun">.</span><span class="pln">split</span><span class="pun">(</span><span class="str">‘ ‘</span><span class="pun">);</span><br>12.  <span class="pln">                </span><span class="com">// 去除掉类名数组中的空字符串</span><br>13.  <span class="pln">                classNameArr </span><span class="pun">=</span><span class="pln"> classNameArr</span><span class="pun">.</span><span class="pln">filter</span><span class="pun">(</span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">value</span><span class="pun">,</span><span class="pln"> key</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>14.  <span class="pln">                    </span><span class="kwd">return</span><span class="pln"> classNameArr</span><span class="pun">[</span><span class="pln">key</span><span class="pun">];</span><br>15.  <span class="pln">                </span><span class="pun">});</span><br>16.  <span class="pln">            </span><span class="pun">}</span><br>17.  <span class="pln">            </span><br>18.  <span class="pln">            </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">var</span><span class="pln"> j </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> classlen </span><span class="pun">=</span><span class="pln"> classNameArr</span><span class="pun">.</span><span class="pln">length</span><span class="pun">;</span><span class="pln"> j </span><span class="pun">&lt;</span><span class="pln"> classlen</span><span class="pun">;</span><span class="pln"> j</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><br>19.  <span class="pln">                </span><br>20.  <span class="pln">                </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">classNameArr</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> className</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>21.  <span class="pln">                    retArr</span><span class="pun">.</span><span class="pln">push</span><span class="pun">(</span><span class="pln">allEle</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]);</span><br>22.  <span class="pln">                    </span><span class="kwd">break</span><span class="pun">;</span><br>23.  <span class="pln">                </span><span class="pun">}</span><br>24.  <span class="pln">            </span><span class="pun">}</span><br>25.  <span class="pln">            </span><br>26.  <span class="pln">        </span><span class="pun">}</span><br>27.  <span class="pln">        </span><span class="kwd">return</span><span class="pln"> retArr</span><span class="pun">;</span><br>28.  <span class="pln">    </span><span class="pun">}</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p><strong><span style="color: #ff0000;">getElementsByTagName(‘*’)</span></strong>的意思是把文档中所有的标签都选择出来的意思。</p>
<p>这样我们就可以模拟jQuery的类名提取方式了。</p>
<p>•<strong><span style="color: #ff0000;">文档碎片documentFragment</span></strong></p>
<p>这个文档碎片就是我们前面提到过nodeType区分节点时候的属性值11的那个文档碎片节点。</p>
<p>文档碎片可以当做<span style="color: #ff0000;">容器</span>来进行<span style="color: #ff0000;">效率的优化</span>。</p>
<p>当我们动态生成很多元素然后加入到文档的时候，因为每一次添加页面都会重新重绘重排一次，效率非常低。</p>
<p><span style="color: #ff0000;">这个时候我们就可以把这些元素全部放到文档碎片里面，然后最后直接把整个文档碎片放进文档就可以了，这样页面只需要重绘重排一次即可。</span></p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">var</span><span class="pln"> fragment </span><span class="pun">=</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">createDocumentFragment</span><span class="pun">();</span><br>3.  <span class="kwd">var</span><span class="pln"> div </span><span class="pun">=</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">createElement</span><span class="pun">(</span><span class="str">‘div’</span><span class="pun">);</span><br>4.  <span class="kwd">var</span><span class="pln"> span </span><span class="pun">=</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">createElement</span><span class="pun">(</span><span class="str">‘span’</span><span class="pun">);</span><br>5.  <span class="kwd">var</span><span class="pln"> p </span><span class="pun">=</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">createElement</span><span class="pun">(</span><span class="str">‘p’</span><span class="pun">);</span><br>6.  <span class="pln">fragment</span><span class="pun">.</span><span class="pln">appendChild</span><span class="pun">(</span><span class="pln">div</span><span class="pun">);</span><br>7.  <span class="pln">fragment</span><span class="pun">.</span><span class="pln">appendChild</span><span class="pun">(</span><span class="pln">span</span><span class="pun">);</span><br>8.  <span class="pln">fragment</span><span class="pun">.</span><span class="pln">appendChild</span><span class="pun">(</span><span class="pln">p</span><span class="pun">);</span><br>9.  <span class="pln">document</span><span class="pun">.</span><span class="pln">body</span><span class="pun">.</span><span class="pln">appendChild</span><span class="pun">(</span><span class="pln">fragment</span><span class="pun">);</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>但是论时间添加事件的话，<span style="color: #ff0000;">文档碎片的添加速度可能会比直接添加的速度要慢</span>，这只是理论上可以节省添加时间，但是在其他方面确实存在优化效果。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/01/02/JavaScriptTwenty2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/02/JavaScriptTwenty2/" itemprop="url">Web前端的知识之旅哟—— BOM与正则表达式</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-01-02T17:52:46+08:00">
                2018-01-02
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="BOM"><a href="#BOM" class="headerlink" title="BOM"></a><span style="color: #ff0000;">BOM</span></h3><p>BOM的全称叫做Browser OjbectModel 浏览器对象模型，它定义了操作浏览器的接口。</p>
<p>BOM对象包括：Window、History、Navigator、Screen和Location。但是由于浏览器厂商的不同，BOM对象的兼容性极低，一般情况下，我们只用其中的一部分功能。</p>
<p>具体请参考w3school中的介绍：</p>
<p><a href="http://www.w3school.com.cn/jsref/index.asp" target="_blank" rel="noopener">http://www.w3school.com.cn/jsref/index.asp</a></p>
<p><span style="color: #ff0000;"><strong>Navigator</strong></span></p>
<p>navigator.userAgent是我们经常使用的属性，它可以返回客户端的代理值。用这个我们就可以判断当前用户使用的是pc端还是移动端，是什么浏览器。</p>
<p><strong><span style="color: #ff0000;">Screen</span></strong></p>
<p>screen.availHeight/availWidth 可以查看除了window任务栏之外的屏幕的高度和宽度。</p>
<p>screen.height/width 返回显示器的屏幕的高度和宽度。不过这个兼容的较少。</p>
<p>screen.deviceXDPI/deviceYDPI返回显示屏幕每英寸的水平/垂直点数，即分辨率。DPI越高，分辨率越高。</p>
<p><strong><span style="color: #ff0000;">History</span></strong></p>
<p>history.length 可以返回当前窗口查看过的网页记录的数量，即浏览历史的长度。</p>
<p>history.back() 可以让浏览器进入到下一个历史页面。</p>
<p>history.forward() &nbsp;可以让浏览器返回到上一个历史页面。</p>
<p>history.go() 这个方法有一个参数，当参数是正数的时候，前进到下一个历史页面，当是负数的时候，回退到上一个历史页面。即前两个的综合方法。</p>
<p><strong><span style="color: #ff0000;">Location</span></strong></p>
<p>location.host 可以返回当前的主机名和当前的URL端口号。比如百度就返回www.baidu.com</p>
<p>location.search 设置或返回从问好开始的URL（查询部分）</p>
<p>location.hash 可以跳转到相应的id的元素的位置，和a标签的锚点功能差不多。可以配合css3的:target一起使用改变元素的样式。</p>
<p>location.reload() 方法可以重新加载当前页面</p>
<p>BOM就介绍这么多，大家可以看看文档学习一下其他的东西。</p>
<h3 id="正则表达式"><a href="#正则表达式" class="headerlink" title="正则表达式"></a><span style="color: #ff0000;">正则表达式</span></h3><p>在开始讲解正则表达式之前，我们先了解一下转义字符“\”。</p>
<p>我们如果想要打印出来双引号，因为双引号本身是一种语法规则，所以正常情况下是打印不出来的，这个时候就需要用到转义字符“/”来把双引号转化成普通的字符而不是语法规则。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="pln">    </span><span class="kwd">var</span><span class="pln"> str </span><span class="pun">=</span><span class="pln"> </span><span class="str">‘\”\”‘</span><span class="pun">;</span><br>3.  <span class="pln">    console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">str</span><span class="pun">);</span><span class="pln"> </span><span class="com">// “”</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>转义字符配合特殊的字母有特殊的意义：</p>
<p>\n 代表字符串和换行</p>
<p>\r 代表字符串的回车</p>
<p>\t 代表制表符tab</p>
<p>等等</p>
<p><span style="color: #ff0000;"><strong>多行字符串</strong></span></p>
<p>1.真正的多行字符串，在每一行最后加一个\n就可以了。</p>
<p>2.为了让结构看起来清晰，我们在编辑器中人为的换行，但是本身并不是多行字符串，这个时候只需要在每一行末尾加一个“\”就可以了。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="pln">    </span><span class="kwd">var</span><span class="pln"> str </span><span class="pun">=</span><span class="pln"> </span><span class="str">‘\</span><br>3.  <span class="str">        &lt;div class=”demo”&gt;\</span><br>4.  <span class="str">            &lt;span&gt;&lt;/span&gt;\</span><br>5.  <span class="str">            &lt;p&gt;&lt;/p&gt;\</span><br>6.  <span class="str">        &lt;/div&gt;\</span><br>7.  <span class="str">        ‘</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>了解了转义字符之后，下面我们正式进入正则表达式部分。</p>
<p><strong><span style="color: #ff0000;">正则表达式的作用</span></strong></p>
<p>正则表达式是进行字符串匹配检测的，当我们为了匹配特殊字符或有特殊匹配原则的字符的时候，正则表达式是最佳的选择。</p>
<p>正则表达式（RegExp）有两种创建方式：</p>
<p>1.直接量</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">var</span><span class="pln"> reg </span><span class="pun">=</span><span class="pln"> </span><span class="str">/abc/</span><span class="pun">;</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>2.构造函数</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">var</span><span class="pln"> reg </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">RegExp</span><span class="pun">(</span><span class="str">‘abc’</span><span class="pun">);</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>要匹配的字符串放在第一个参数，或者将一个现成的正则表达式放进第一个参数。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">var</span><span class="pln"> reg </span><span class="pun">=</span><span class="pln"> </span><span class="str">/abc/</span><span class="pun">;</span><br>3.  <span class="kwd">var</span><span class="pln"> reg2 </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">RegExp</span><span class="pun">(</span><span class="pln">reg</span><span class="pun">);</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p><strong><span style="color: #ff0000;">修饰符</span></strong></p>
<p>一个正则表达式有三个描述的属性g、i、m，表示三种特定的修饰功能。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">var</span><span class="pln"> reg </span><span class="pun">=</span><span class="pln"> </span><span class="str">/abc/</span><span class="pln">gim</span><span class="pun">;</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>在直接量中直接在后面加上gim就可以了，但是在构造函数中，我们要把修饰符放在第二个参数上。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">var</span><span class="pln"> reg </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">RegExp</span><span class="pun">(</span><span class="str">‘abc’</span><span class="pun">,</span><span class="pln"> </span><span class="str">‘gim’</span><span class="pun">);</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>这两种写出来的效果是一模一样的，但是由于构造函数书写起来太麻烦而且还需要转义字符，个人推荐用直接量来构造正则表达式。</p>
<p>正则表达式上面有一个方法test()，可以测试一个字符串符不符合这个匹配规则。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">var</span><span class="pln"> reg </span><span class="pun">=</span><span class="pln"> </span><span class="str">/abc/</span><span class="pln">g</span><span class="pun">;</span><br>3.  <span class="pln">console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">reg</span><span class="pun">.</span><span class="pln">test</span><span class="pun">(</span><span class="str">‘abcabc’</span><span class="pun">));</span><span class="pln"> </span><span class="com">// true</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>这样就实现了一个最基本的匹配了。</p>
<p>1.i （ignore） 可以忽略大小写。</p>
<p>2.g （global） 全局匹配。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">var</span><span class="pln"> reg </span><span class="pun">=</span><span class="pln"> </span><span class="str">/abc/</span><span class="pun">;</span><br>3.  <span class="kwd">var</span><span class="pln"> str </span><span class="pun">=</span><span class="pln"> </span><span class="str">‘abcabcabc’</span><span class="pun">;</span><br>4.  <span class="pln">console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">str</span><span class="pun">.</span><span class="pln">match</span><span class="pun">(</span><span class="pln">reg</span><span class="pun">));</span><span class="pln"> </span><span class="com">// [“abc”, index: 0, input: “abcabcabc”]</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>不写g的时候会返回一个类数组，写上g会返回一个数组，里面有所有的3个abc。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">var</span><span class="pln"> reg </span><span class="pun">=</span><span class="pln"> </span><span class="str">/abc/</span><span class="pln">g</span><span class="pun">;</span><br>3.  <span class="kwd">var</span><span class="pln"> str </span><span class="pun">=</span><span class="pln"> </span><span class="str">‘abcabcabc’</span><span class="pun">;</span><br>4.  <span class="pln">console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">str</span><span class="pun">.</span><span class="pln">match</span><span class="pun">(</span><span class="pln">reg</span><span class="pun">));</span><span class="pln"> </span><span class="com">// [“abc”, “abc”, “abc”]</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>3.m （multiline）多行匹配</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">var</span><span class="pln"> reg </span><span class="pun">=</span><span class="pln"> </span><span class="str">/^e/</span><span class="pln">igm</span><span class="pun">;</span><br>3.  <span class="kwd">var</span><span class="pln"> str </span><span class="pun">=</span><span class="pln"> </span><span class="str">“abc\nebcd”</span><span class="pun">;</span><br>4.  <span class="pln">console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">str</span><span class="pun">.</span><span class="pln">match</span><span class="pun">(</span><span class="pln">reg</span><span class="pun">));</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>这个reg的作用是匹配以e开头的字符串，如果不加m，这个str是无法匹配的，因为\n也算一个字符，它后面的e不算是开头的字符，但是加上m之后，\n就会被正则表达式看成是正常的换行符，因此后面的e会被看做是下一行的开头的字符，因此就可以匹配出来了。</p>
<p><strong><span style="color: #ff0000;">表达式</span></strong></p>
<p>1.[abc] 查找方括号之间的任何字符。</p>
<p>匹配的是一位字符，不过是括号里面的任何一位都可以。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">var</span><span class="pln"> reg </span><span class="pun">=</span><span class="pln"> </span><span class="str">/[abcd]/</span><span class="pln">g</span><span class="pun">;</span><br>3.  <span class="kwd">var</span><span class="pln"> str </span><span class="pun">=</span><span class="pln"> </span><span class="str">‘code’</span><span class="pun">;</span><br>4.  <span class="pln">console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">str</span><span class="pun">.</span><span class="pln">match</span><span class="pun">(</span><span class="pln">reg</span><span class="pun">));</span><span class="pln"> </span><span class="com">// [“c”, “d”]</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>现在反悔的一个数组，把str中的所有a或者b或者c都返回出来了。</p>
<p>我们还可以写一个范围，比如[a-zA-Z0-9]，这样就代表所有的英文字母和数字。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">var</span><span class="pln"> reg </span><span class="pun">=</span><span class="pln"> </span><span class="str">/[a-zA-Z0-9]/</span><span class="pln">g</span><span class="pun">;</span><br>3.  <span class="kwd">var</span><span class="pln"> str </span><span class="pun">=</span><span class="pln"> </span><span class="str">‘code1024’</span><span class="pun">;</span><br>4.  <span class="pln">console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">str</span><span class="pun">.</span><span class="pln">match</span><span class="pun">(</span><span class="pln">reg</span><span class="pun">));</span><span class="pln"> </span><span class="com">// [“c”, “o”, “d”, “e”, “1”, “0”, “2”, “4”]</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>这样匹配出来的就是一个code1024</p>
<p>2.[^abc] 查找任何不属于方括号里面的字符</p>
<p>注意这里的“^”是写在方括号里面的，和前面的代表开头的“^”不是一个意思。当这个符号出现在方括号里面的时候，就代表非的意思，除了方括号里面写的，其他的字符都符合。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">var</span><span class="pln"> reg </span><span class="pun">=</span><span class="pln"> </span><span class="str">/[^a-zA-Z]/</span><span class="pln">g</span><span class="pun">;</span><br>3.  <span class="kwd">var</span><span class="pln"> str </span><span class="pun">=</span><span class="pln"> </span><span class="str">‘code1024’</span><span class="pun">;</span><br>4.  <span class="pln">console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">str</span><span class="pun">.</span><span class="pln">match</span><span class="pun">(</span><span class="pln">reg</span><span class="pun">));</span><span class="pln"> </span><span class="com">// [“1”, “0”, “2”, “4”]</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>这个表达式的意思就是除了字母之外的其他字符都符合要求。</p>
<p>3.()</p>
<p>括号的作用是提高优先级和产生子表达式的作用。</p>
<p>4.|</p>
<p>或表达式，和[]差不多，可以配合()来使用。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">var</span><span class="pln"> reg </span><span class="pun">=</span><span class="pln"> </span><span class="str">/a|b/</span><span class="pln">g</span><span class="pun">;</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>这个正则表达式代表ab或者cb都可以。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">var</span><span class="pln"> reg </span><span class="pun">=</span><span class="pln"> </span><span class="str">/(a|c)b)/</span><span class="pln">g</span><span class="pun">;</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div><br><div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">var</span><span class="pln"> reg </span><span class="pun">=</span><span class="str">/(blue|red)abc/</span><span class="pun">;</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>如果不加括号的话，就是匹配blue或者redabc，现在加上括号了就是匹配blueabc或者redabc。</p>
<p><strong><span style="color: #ff0000;">元字符</span></strong></p>
<p>和表达式差不多，元字符是代表区间的。</p>
<p>1.“.”</p>
<p>这个符号可以匹配除了换行符（\n）和行结束符（\r），除了这两个字符之外其他的字符都可以匹配出来。</p>
<p>2.\w</p>
<p>这个元字符代表单词字符的意思，即A-Za-z0-9_</p>
<p>注意这个是可以匹配下划线的。</p>
<p>3.\W</p>
<p>除了\w的单词字符之外的其他字符。</p>
<p>4.\d</p>
<p>代表数字字符，即0-9</p>
<p>5\D</p>
<p>代表除了数字字符之外的其他字符。</p>
<p>6.\s</p>
<p>查找空白字符。</p>
<p>空白字符都包括：空格符、制表符（\t）、回车符（\r），换行符（\n），垂直换行符（\v）、换页符（\f）。</p>
<p>因此\s = [\n\t\r\v\f];</p>
<p>7.\S</p>
<p>查找非空白字符，即除了\s包括的空白字符之外的其他字符。</p>
<p>我们如果要匹配任意字符的话，就可以搭配起来使用了：</p>
<p>[\s\S]、[\d\D]、[\w\W]等都可以</p>
<p>8.\b</p>
<p>匹配单词边界。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">var</span><span class="pln"> str </span><span class="pun">=</span><span class="pln"> </span><span class="str">‘accb bdaccd efg’</span><span class="pun">;</span><br>3.  <span class="kwd">var</span><span class="pln"> reg </span><span class="pun">=</span><span class="pln"> </span><span class="str">/\bacc/</span><span class="pun">;</span><br>4.  <span class="pln">console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">str</span><span class="pun">.</span><span class="pln">match</span><span class="pun">(</span><span class="pln">reg</span><span class="pun">));</span><span class="pln"> </span><span class="com">// [“acc”]</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>这样匹配的就是第一个acc，后面的acc前面不是单词边界，因此不符合匹配规则。</p>
<p>9.\B</p>
<p>非单词边界</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">var</span><span class="pln"> str </span><span class="pun">=</span><span class="pln"> </span><span class="str">‘accb bdaccd efg’</span><span class="pun">;</span><br>3.  <span class="kwd">var</span><span class="pln"> reg </span><span class="pun">=</span><span class="pln"> </span><span class="str">/\Bacc/</span><span class="pun">;</span><br>4.  <span class="pln">console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">str</span><span class="pun">.</span><span class="pln">match</span><span class="pun">(</span><span class="pln">reg</span><span class="pun">));</span><span class="pln"> </span><span class="com">// [“acc”]</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>匹配的就是中间的acc。</p>
<p>注意，一个汉字就是一个单词，每一个汉字的两边都有默认的单词边界。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">var</span><span class="pln"> str </span><span class="pun">=</span><span class="pln"> </span><span class="str">‘维生素c’</span><span class="pun">;</span><br>3.  <span class="kwd">var</span><span class="pln"> reg </span><span class="pun">=</span><span class="pln"> </span><span class="str">/\bc/</span><span class="pun">;</span><br>4.  <span class="pln">console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">str</span><span class="pun">.</span><span class="pln">match</span><span class="pun">(</span><span class="pln">reg</span><span class="pun">));</span><span class="pln"> </span><span class="com">// [“c”, index: 3, input: “维生素c”]</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p><strong><span style="color: #ff0000;">量词</span></strong></p>
<p>以下的n代表一个变量，可以是表达式或者元字符。</p>
<p>1.n+</p>
<p>匹配至少一个变量n</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">var</span><span class="pln"> str </span><span class="pun">=</span><span class="pln"> </span><span class="str">‘bcdaaaaagbaaasaaka’</span><span class="pun">;</span><br>3.  <span class="kwd">var</span><span class="pln"> reg </span><span class="pun">=</span><span class="pln"> </span><span class="str">/a+/</span><span class="pln">g</span><span class="pun">;</span><br>4.  <span class="pln">console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">str</span><span class="pun">.</span><span class="pln">match</span><span class="pun">(</span><span class="pln">reg</span><span class="pun">));</span><span class="pln"> </span><span class="com">// [“aaaaa”, “aaa”, “aa”, “a”]</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>可以把全部的a当做一位来匹配出来。</p>
<p>2.n*</p>
<p>匹配至少零个变量n</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">var</span><span class="pln"> reg </span><span class="pun">=</span><span class="pln"> </span><span class="str">/a*c/</span><span class="pln">g</span><span class="pun">;</span><br>3.  <span class="kwd">var</span><span class="pln"> str </span><span class="pun">=</span><span class="pln"> </span><span class="str">‘abc’</span><span class="pun">;</span><span class="pln"> </span><br>4.  <span class="pln">console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">str</span><span class="pun">.</span><span class="pln">match</span><span class="pun">(</span><span class="pln">reg</span><span class="pun">));</span><span class="pln"> </span><span class="com">// [“c”]</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>这种情况下只有前面是a*0才有可能匹配成功。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">var</span><span class="pln"> reg </span><span class="pun">=</span><span class="pln"> </span><span class="str">/\w*/</span><span class="pln">g</span><span class="pun">;</span><br>3.  <span class="kwd">var</span><span class="pln"> str </span><span class="pun">=</span><span class="pln"> </span><span class="str">‘aabbbccc’</span><span class="pun">;</span><br>4.  <span class="pln">console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">str</span><span class="pun">.</span><span class="pln">match</span><span class="pun">(</span><span class="pln">reg</span><span class="pun">));</span><span class="pln"> </span><span class="com">// [“aabbbccc”, “”]</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>最后有一个空串，因为前面的单词被\w<em>匹配出来，最后还有一个空字符可以被\w</em>0匹配出来。</p>
<p>两个字符之间都有一个空字符， ab-&gt; [‘a’, ”, ‘b’];</p>
<p>3.n?</p>
<p>匹配0-1个变量n</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">var</span><span class="pln"> reg</span><span class="pun">=</span><span class="str">/(aa|b)?/</span><span class="pln">g</span><span class="pun">;</span><br>3.  <span class="kwd">var</span><span class="pln"> str </span><span class="pun">=</span><span class="pln"> </span><span class="str">‘aaaaacb’</span><span class="pun">;</span><br>4.  <span class="pln">console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">str</span><span class="pun">.</span><span class="pln">match</span><span class="pun">(</span><span class="pln">reg</span><span class="pun">));</span><span class="pln"> </span><span class="com">// [“aa”, “aa”, “”, “”, “b”, “”]</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>中间的空串是因为匹配了空串，?取0的情况。</p>
<p>4.n{x}</p>
<p>可以规定匹配x个变量n</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">var</span><span class="pln"> reg </span><span class="pun">=</span><span class="pln"> </span><span class="str">/a{4}/</span><span class="pun">;</span><br>3.  <span class="kwd">var</span><span class="pln"> str </span><span class="pun">=</span><span class="pln"> </span><span class="str">‘aaaaa’</span><span class="pun">;</span><br>4.  <span class="pln">console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">str</span><span class="pun">.</span><span class="pln">match</span><span class="pun">(</span><span class="pln">reg</span><span class="pun">));</span><span class="pln"> </span><span class="com">// [“aaaa”, index: 0, input: “aaaaa”]</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>并且大括号可以写一个区间，中间用逗号链接。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">var</span><span class="pln"> reg </span><span class="pun">=</span><span class="pln"> </span><span class="str">/a{1,4}/</span><span class="pln">g</span><span class="pun">;</span><br>3.  <span class="kwd">var</span><span class="pln"> str </span><span class="pun">=</span><span class="pln"> </span><span class="str">‘aaaaa’</span><span class="pun">;</span><br>4.  <span class="pln">console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">str</span><span class="pun">.</span><span class="pln">match</span><span class="pun">(</span><span class="pln">reg</span><span class="pun">));</span><span class="pln"> </span><span class="com">// [“aaaa”, “a”]</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>或者第二个范围不写，这样就代表到无穷的范围。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">var</span><span class="pln"> reg </span><span class="pun">=</span><span class="pln"> </span><span class="str">/a{1,}/</span><span class="pln">g</span><span class="pun">;</span><br>3.  <span class="kwd">var</span><span class="pln"> str </span><span class="pun">=</span><span class="pln"> </span><span class="str">‘aaaaa’</span><span class="pun">;</span><br>4.  <span class="pln">console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">str</span><span class="pun">.</span><span class="pln">match</span><span class="pun">(</span><span class="pln">reg</span><span class="pun">));</span><span class="pln"> </span><span class="com">// [“aaaaa”]</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>这里默认的是贪婪匹配，即尽可能匹配多个字符。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">var</span><span class="pln"> reg </span><span class="pun">=</span><span class="pln"> </span><span class="str">/a{1,4}/</span><span class="pln">g</span><span class="pun">;</span><br>3.  <span class="kwd">var</span><span class="pln"> str </span><span class="pun">=</span><span class="pln"> </span><span class="str">‘aaaaaa’</span><span class="pun">;</span><br>4.  <span class="pln">console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">str</span><span class="pun">.</span><span class="pln">match</span><span class="pun">(</span><span class="pln">reg</span><span class="pun">));</span><span class="pln"> </span><span class="com">// [“aaaa”, “aa”]</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>当我们在后面加一个”?”之后，就会变成最小匹配，尽可能匹配少的字符。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">var</span><span class="pln"> reg </span><span class="pun">=</span><span class="pln"> </span><span class="str">/a{1,4}?/</span><span class="pln">g</span><span class="pun">;</span><br>3.  <span class="kwd">var</span><span class="pln"> str </span><span class="pun">=</span><span class="pln"> </span><span class="str">‘aaaaaa’</span><span class="pun">;</span><br>4.  <span class="pln">console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">str</span><span class="pun">.</span><span class="pln">match</span><span class="pun">(</span><span class="pln">reg</span><span class="pun">));</span><span class="pln"> </span><span class="com">// [“a”, “a”, “a”, “a”, “a”, “a”]</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>当然，不只是{}后面可以加”?”，其他的比如*?、+?等等后面都可以加问号。</p>
<p>5.n$</p>
<p>匹配以n结尾的字符</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">var</span><span class="pln"> reg </span><span class="pun">=</span><span class="pln"> </span><span class="str">/ab$/</span><span class="pun">;</span><br>3.  <span class="kwd">var</span><span class="pln"> str </span><span class="pun">=</span><span class="pln"> </span><span class="str">‘abab’</span><span class="pun">;</span><span class="pln"> </span><br>4.  <span class="pln">console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">str</span><span class="pun">.</span><span class="pln">match</span><span class="pun">(</span><span class="pln">reg</span><span class="pun">));</span><span class="pln"> </span><span class="com">// [“ab”, index: 2, input: “abab”]</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>只能找到最后一组ab</p>
<p>6.^n</p>
<p>匹配以n开头的字符，注意不是[]里面的^。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">var</span><span class="pln"> reg </span><span class="pun">=</span><span class="pln"> </span><span class="str">/^acb/</span><span class="pln">g</span><span class="pun">;</span><br>3.  <span class="kwd">var</span><span class="pln"> str </span><span class="pun">=</span><span class="pln"> </span><span class="str">‘acbacb’</span><span class="pun">;</span><br>4.  <span class="pln">console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">str</span><span class="pun">.</span><span class="pln">match</span><span class="pun">(</span><span class="pln">reg</span><span class="pun">));</span><span class="pln"> </span><span class="com">// [“acb”]</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>只能匹配出来第一个acb。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">var</span><span class="pln"> reg </span><span class="pun">=</span><span class="pln"> </span><span class="str">/^ab$/</span><span class="pln">g</span><span class="pun">;;</span><br>3.  <span class="kwd">var</span><span class="pln"> str </span><span class="pun">=</span><span class="pln"> </span><span class="str">‘abcabc’</span><span class="pun">;</span><br>4.  <span class="pln">console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">str</span><span class="pun">.</span><span class="pln">match</span><span class="pun">(</span><span class="pln">reg</span><span class="pun">));</span><span class="pln"> </span><span class="com">// null</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>这种写法就要求从a开头，挨着的b是结尾的。”abab“现在就匹配不出来了。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">var</span><span class="pln"> reg </span><span class="pun">=</span><span class="pln"> </span><span class="str">/^abc$/</span><span class="pln">g</span><span class="pun">;;</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>这种写法可以匹配固定字符串abc。</p>
<p>小题目：</p>
<p>写一个正则表达式，检验字符串首尾是否有数字。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">var</span><span class="pln"> reg </span><span class="pun">=</span><span class="pln"> </span><span class="str">/^\d|\d$/</span><span class="pln">gi</span><span class="pun">;</span><br>3.  <span class="pln">console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">reg</span><span class="pun">.</span><span class="pln">test</span><span class="pun">(</span><span class="str">‘12asdfv’</span><span class="pun">));</span><span class="pln"> </span><span class="com">// true</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>7.n(?=xxx)</p>
<p>正向预查（正向断言）</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">var</span><span class="pln"> reg </span><span class="pun">=</span><span class="pln"> </span><span class="str">/x(?=abc)/</span><span class="pln">g</span><span class="pun">;</span><br>3.  <span class="kwd">var</span><span class="pln"> str </span><span class="pun">=</span><span class="pln"> </span><span class="str">‘xabcxbcdaabc’</span><span class="pun">;</span><span class="pln"> </span><br>4.  <span class="pln">console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">str</span><span class="pun">.</span><span class="pln">match</span><span class="pun">(</span><span class="pln">reg</span><span class="pun">));</span><span class="pln"> </span><span class="com">// x</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>后面是abc的那个n，匹配的是n，后面有abc是一种条件。</p>
<p>如果n是一个空，那么就查找后面是abc的a前面那个空串了。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">var</span><span class="pln"> reg </span><span class="pun">=</span><span class="pln"> </span><span class="str">/(?=abc)/</span><span class="pln">g</span><span class="pun">;</span><br>3.  <span class="kwd">var</span><span class="pln"> str </span><span class="pun">=</span><span class="pln"> </span><span class="str">‘xabcxbcdaabc’</span><span class="pun">;</span><span class="pln"> </span><br>4.  <span class="pln">console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">str</span><span class="pun">.</span><span class="pln">match</span><span class="pun">(</span><span class="pln">reg</span><span class="pun">));</span><span class="pln"> </span><span class="com">// [“”, “”]</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>8.n(?!xxx)</p>
<p>非正向预查</p>
<p>匹配后面不是abc的n。</p>
<p>• 我们如果要匹配*、?等这些字符的话，就需要在前面加上一个转义字符“/”了。</p>
<h3 id="RegExp对象"><a href="#RegExp对象" class="headerlink" title="RegExp对象"></a><strong><span style="color: #ff0000;">RegExp对象</span></strong></h3><p><strong><span style="color: #ff0000;">属性</span></strong></p>
<p>1.global multiline ignoreCase</p>
<p>这三个属性可以检测是否有gim修饰。</p>
<p>2.source</p>
<p>代表正则表达式本身，即两个斜线中间的部分。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">var</span><span class="pln"> reg </span><span class="pun">=</span><span class="pln"> </span><span class="str">/abc\w\d/</span><span class="pln">gim</span><span class="pun">;</span><br>3.  <span class="pln">console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">reg</span><span class="pun">.</span><span class="pln">source</span><span class="pun">);</span><span class="pln"> </span><span class="com">// abc\w\d</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p><strong><span style="color: #ff0000;">方法</span></strong></p>
<p>1.exec</p>
<p>这个方法可以检测字符串中指定的值，返回知道的值并确定其位置。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">var</span><span class="pln"> reg </span><span class="pun">=</span><span class="pln"> </span><span class="str">/abc/</span><span class="pun">;</span><br>3.  <span class="kwd">var</span><span class="pln"> str </span><span class="pun">=</span><span class="pln"> </span><span class="str">“bcabcdabcda”</span><span class="pun">;</span><br>4.  <span class="pln">console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">reg</span><span class="pun">.</span><span class="kwd">exec</span><span class="pun">(</span><span class="pln">str</span><span class="pun">));</span><span class="pln"> </span><span class="com">// [“abc”, index: 2, input: “bcabcdabcda”]</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>返回的是一个类数组，其中的index是匹配出的字符开始的位置。</p>
<p>不论执行多少次结果都一样。</p>
<p>jQuery源码里面就用了很多exec方法。</p>
<p>我们前面提到()括号除了优先级之外，还可以产生子表达式。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">var</span><span class="pln"> reg </span><span class="pun">=</span><span class="pln"> </span><span class="str">/(a)(b)(c)/</span><span class="pun">;</span><br>3.  <span class="kwd">var</span><span class="pln"> str </span><span class="pun">=</span><span class="pln"> </span><span class="str">“bcabcdabcda”</span><span class="pun">;</span><br>4.  <span class="pln">console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">reg</span><span class="pun">.</span><span class="kwd">exec</span><span class="pun">(</span><span class="pln">str</span><span class="pun">));</span><span class="pln"> </span><span class="com">// [“abc”, “a”, “b”, “c”, index: 2, input: “bcabcdabcda”]</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>返回的类数组会把三个子表达式匹配的内容也写出来。</p>
<p>第一个子表达式的a是第一个abc里面的a，子表达式b是abc里面的b，子表达式c是abc里面的c。</p>
<p>当我们不想让括号匹配出来字符作为子表达式，只充当优先级的作用的时候，那么在()的最前面加上“?:”就可以取消子表达式的作用了。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">var</span><span class="pln"> reg </span><span class="pun">=</span><span class="pln"> </span><span class="str">/(?:a)(?:b)(c)/</span><span class="pun">;</span><br>3.  <span class="kwd">var</span><span class="pln"> str </span><span class="pun">=</span><span class="pln"> </span><span class="str">“bcabcdabcda”</span><span class="pun">;</span><br>4.  <span class="pln">console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">reg</span><span class="pun">.</span><span class="kwd">exec</span><span class="pun">(</span><span class="pln">str</span><span class="pun">));</span><span class="pln"> </span><span class="com">// [“abc”, “c”, index: 2, input: “bcabcdabcda”]</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>这里的”?:”叫做不记录子表达式。</p>
<p>而有了子表达式，我们也有相应的可以选择出子表达式的表达式。</p>
<p>反向引用：</p>
<p>匹配形如1221形式的字符串，比如abba，deed等。我们可以通过子表达式和反向引用就可以实现。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">var</span><span class="pln"> reg </span><span class="pun">=</span><span class="pln"> </span><span class="str">/(\w)(\w)\2\1/</span><span class="pln"> </span><span class="pun">;</span><br>3.  <span class="kwd">var</span><span class="pln"> str </span><span class="pun">=</span><span class="pln"> </span><span class="str">“abba”</span><span class="pun">;</span><br>4.  <span class="pln">console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">reg</span><span class="pun">.</span><span class="kwd">exec</span><span class="pun">(</span><span class="pln">str</span><span class="pun">));</span><span class="pln"> </span><span class="com">// [“abba”, “a”, “b”, index: 0, input: “abba”]</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>\1代表和第一个子表达式匹配到的相同的内容，第一个\w匹配到什么这里的\1就是什么，\2同理。</p>
<p>以上是我们的正则表达式没有写g全局时候的情况，当我们写上g之后情况又会变得不一样了。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">var</span><span class="pln"> reg </span><span class="pun">=</span><span class="pln"> </span><span class="str">/abc/</span><span class="pln">g</span><span class="pun">;</span><br>3.  <span class="kwd">var</span><span class="pln"> str </span><span class="pun">=</span><span class="pln"> </span><span class="str">“bcabcdabcda”</span><span class="pun">;</span><br>4.  <span class="pln">console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">reg</span><span class="pun">.</span><span class="kwd">exec</span><span class="pun">(</span><span class="pln">str</span><span class="pun">));</span><span class="pln"> </span><span class="com">// [“abc”, index: 2, input: “bcabcdabcda”]</span><br>5.  <span class="pln">console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">reg</span><span class="pun">.</span><span class="kwd">exec</span><span class="pun">(</span><span class="pln">str</span><span class="pun">));</span><span class="pln"> </span><span class="com">// [“abc”, index: 6, input: “bcabcdabcda”]</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>执行第一次的结果和没有全局时候是一样的，但是从第二次开始就不同了。</p>
<p>第二次index变成了6，匹配的是第二组abc。</p>
<p>所以加上g之后，后面的匹配开始的位置是从上一次匹配结束的位置开始，而不是从头开始。</p>
<p>如果走到最后也没有符合的字符串的话，就会返回null。但是下一再执行会回到开头开始匹配。</p>
<p>这一切不同之处都是因为正则表达式还有一个属性叫做lastIndex，这个属性基本只有全局的时候才有作用。他会记录表达式上一次匹配完了之后的位置，然后让下一次匹配从lastIndex的位置开始。</p>
<p>如果我们中途改变了lastIndex 的数值，那么我们就可以改变下一次匹配开始的位置了。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">var</span><span class="pln"> reg </span><span class="pun">=</span><span class="pln"> </span><span class="str">/abc/</span><span class="pln">g</span><span class="pun">;</span><br>3.  <span class="kwd">var</span><span class="pln"> str </span><span class="pun">=</span><span class="pln"> </span><span class="str">“bcabcdabcda”</span><span class="pun">;</span><br>4.  <span class="pln">reg</span><span class="pun">.</span><span class="pln">lastIndex </span><span class="pun">=</span><span class="pln"> </span><span class="lit">4</span><span class="pun">;</span><br>5.  <span class="pln">console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">reg</span><span class="pun">.</span><span class="kwd">exec</span><span class="pun">(</span><span class="pln">str</span><span class="pun">));</span><span class="pln"> </span><span class="com">// [“abc”, index: 6, input: “bcabcdabcda”]</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>现在第一次执行结果匹配的就是第二个abc。</p>
<h3 id="String上的一些方法"><a href="#String上的一些方法" class="headerlink" title="String上的一些方法"></a><span style="color: #ff0000;">String上的一些方法</span></h3><p>1.search</p>
<p>检索与正则表达式相匹配的位置，匹配成功即结束，与g无关，匹配失败则会返回-1。</p>
<p>2.match</p>
<p>找到一个或多个正则表达式的匹配，当非全局匹配时和exec显示的一样，是一个类数组，但是没有lastIndex，全局匹配时会返回一个数组。</p>
<p>3.split</p>
<p>split是以什么为分隔符把字符串分割成一个数组，这里的分隔符可以写一个正则表达式。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">var</span><span class="pln"> reg </span><span class="pun">=</span><span class="pln"> </span><span class="str">/[-\d]/</span><span class="pln">g</span><span class="pun">;</span><br>3.  <span class="kwd">var</span><span class="pln"> str </span><span class="pun">=</span><span class="pln"> </span><span class="str">‘a-c-d-a0f-e’</span><span class="pun">;</span><br>4.  <span class="pln">console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">str</span><span class="pun">.</span><span class="pln">split</span><span class="pun">(</span><span class="pln">reg</span><span class="pun">));</span><span class="pln"> </span><span class="com">// [“a”, “c”, “d”, “a”, “f”, “e”]</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>4.replace</p>
<p>替换与正则表达式匹配的字串。</p>
<p>这个方法非常非常重要，配合正则表达式会变得很灵活。</p>
<p>str.replace()有两个参数，第一个是目标字符串，可以是一个正则表达式，也可以是一个字符串，第二个参数是替换成的字符串。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">var</span><span class="pln"> str </span><span class="pun">=</span><span class="pln"> </span><span class="str">‘abcdbcdbcd’</span><span class="pun">;</span><br>3.  <span class="kwd">var</span><span class="pln"> reg </span><span class="pun">=</span><span class="pln"> </span><span class="str">/ab/</span><span class="pln">g</span><span class="pun">;</span><br>4.  <span class="pln">console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">str</span><span class="pun">.</span><span class="pln">replace</span><span class="pun">(</span><span class="str">‘bc’</span><span class="pun">,</span><span class="pln"> </span><span class="str">‘aa’</span><span class="pun">));</span><span class="pln"> </span><span class="com">// aaadbcdbcd</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>只改第一个ab，后面的ab不改。</p>
<p>变成aaadbcdbcd。</p>
<p>如果想要全部替换就要写正则表达式。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">var</span><span class="pln"> str </span><span class="pun">=</span><span class="pln"> </span><span class="str">‘abcdbcdbcd’</span><span class="pun">;</span><br>3.  <span class="kwd">var</span><span class="pln"> reg </span><span class="pun">=</span><span class="pln"> </span><span class="str">/(\w)(\w)/</span><span class="pln">g</span><span class="pun">;</span><br>4.  <span class="pln">console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">str</span><span class="pun">.</span><span class="pln">replace</span><span class="pun">(</span><span class="pln">reg</span><span class="pun">,</span><span class="pln"> </span><span class="str">‘aa’</span><span class="pun">));</span><span class="pln"> </span><span class="com">// aaaaaaaaaa</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>现在有一个字符串“ab”，如果我们想要通过正则表达式来调换两个字母的位置，也需要用这个方法。</p>
<p>在第二个参数的位置，字符串里面可以写$、$1、$2…等等，其中$代表匹配出来的字符串，$1代表子表达式1，$2代表子表达式2.。</p>
<p>这样我们通过这种参数就可以实现简单的交换字母了。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">var</span><span class="pln"> str </span><span class="pun">=</span><span class="pln"> </span><span class="str">‘ab’</span><span class="pun">;</span><br>3.  <span class="kwd">var</span><span class="pln"> reg </span><span class="pun">=</span><span class="pln"> </span><span class="str">/(\w)(\w)/</span><span class="pln">g</span><span class="pun">;</span><br>4.  <span class="pln">console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">str</span><span class="pun">.</span><span class="pln">replace</span><span class="pun">(</span><span class="pln">reg</span><span class="pun">,</span><span class="pln"> </span><span class="str">‘$2$1’</span><span class="pun">));</span><span class="pln"> </span><span class="com">// ba</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>当然这只是第一种用法，还有第二种用法，在第二个参数中可以传一个函数，系统会自动调用这个函数，然后替换成这个函数返回的字符串。</p>
<p>var str = ‘ab’;</p>
<p>var reg = /(\w)(\w)/g;</p>
<p>console.log(str.replace(reg, function () {</p>
<pre><code>return ‘abc’
</code></pre><p>})); // abc</p>
<p>整体被替换成了abc。</p>
<p>函数可以写形参，从前到后分别代表匹配出来的字符串、第一个子表达式、第二个子表达式等等。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">var</span><span class="pln"> str </span><span class="pun">=</span><span class="pln"> </span><span class="str">‘ab’</span><span class="pun">;</span><br>3.  <span class="kwd">var</span><span class="pln"> reg </span><span class="pun">=</span><span class="pln"> </span><span class="str">/(\w)(\w)/</span><span class="pln">g</span><span class="pun">;</span><br>4.  <span class="pln">console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">str</span><span class="pun">.</span><span class="pln">replace</span><span class="pun">(</span><span class="pln">reg</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">$</span><span class="pun">,</span><span class="pln"> $1</span><span class="pun">,</span><span class="pln"> $2</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>5.  <span class="pln">    </span><span class="kwd">return</span><span class="pln"> $2 </span><span class="pun">+</span><span class="pln"> $1</span><span class="pun">;</span><br>6.  <span class="pun">}));</span><span class="pln"> </span><span class="com">// ba</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>这个样子同样可以实现交换字母的功能。</p>
<p>正则表达式的大部分知识点就这么多哟~</p>
<p>下面我们来做几个题目练习一下正则表达式的使用吧！</p>
<p>1.将形如aaaabbbb字符串调换成bbbbaaaa形式。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">var</span><span class="pln"> str </span><span class="pun">=</span><span class="pln"> </span><span class="str">‘aaaabbbb’</span><span class="pun">;</span><br>3.  <span class="kwd">var</span><span class="pln"> reg </span><span class="pun">=</span><span class="pln"> </span><span class="str">/(\w{4})(\w{4})/</span><span class="pln">g</span><span class="pun">;</span><br>4.  <span class="pln">str</span><span class="pun">.</span><span class="pln">replace</span><span class="pun">(</span><span class="pln">reg</span><span class="pun">,</span><span class="pln"> </span><span class="str">‘$2$1’</span><span class="pun">);</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>2.将‘my-fist-name’这样的用‘-’连接字符串变成小驼峰式的写法。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">var</span><span class="pln"> str </span><span class="pun">=</span><span class="pln"> </span><span class="str">‘my-first-name’</span><span class="pun">;</span><br>3.  <span class="kwd">var</span><span class="pln"> reg </span><span class="pun">=</span><span class="pln"> </span><span class="str">/-(\w)/</span><span class="pln">g</span><span class="pun">;</span><br>4.  <span class="pln">str</span><span class="pun">.</span><span class="pln">replace</span><span class="pun">(</span><span class="pln">reg</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">$</span><span class="pun">,</span><span class="pln"> $1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>5.  <span class="pln">    </span><span class="kwd">return</span><span class="pln"> $1</span><span class="pun">.</span><span class="pln">toUpperCase</span><span class="pun">();</span><br>6.  <span class="pun">})</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>3.将一串连续的数字，变成如下形式：</p>
<p>100000000 —&gt; 100,000,000</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">var</span><span class="pln"> str </span><span class="pun">=</span><span class="pln"> </span><span class="str">‘100000000’</span><span class="pun">;</span><br>3.  <span class="kwd">var</span><span class="pln"> reg </span><span class="pun">=</span><span class="pln"> </span><span class="str">/(?=((\B)\d{3})+$)/</span><span class="pln">g</span><span class="pun">;</span><br>4.  <span class="pln">console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">str</span><span class="pun">.</span><span class="pln">replace</span><span class="pun">(</span><span class="pln">reg</span><span class="pun">,</span><span class="pln"> </span><span class="str">‘,’</span><span class="pun">));</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div><br>                
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/01/02/JavaScriptTwenty1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/02/JavaScriptTwenty1/" itemprop="url">Web前端的知识之旅哟—— 异步加载JS</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-01-02T17:52:41+08:00">
                2018-01-02
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>先介绍一下JSON：</p>
<p>我们传输数据就两种格式：<span style="color: #ff0000;">xml和json</span>。</p>
<p>xml是以<span style="color: #ff0000;">html</span>为模板，自定义标签名作为数据名来传递数据，书写起来很麻烦，现在多用json，很少使用xml。</p>
<p>json是传输数据的另一种格式，它是以<span style="color: #ff0000;">对象</span>为模板（本质上就是对象，但是用途有所区别，对象是本地使用，json是用来传输数据）。</p>
<p>不过我们传输数据的时候并不能将一个json对象直接传过去，我们只能传过去json形式的字符串，这个时候我们就需要用到JSON上的两个方法了。</p>
<p><span style="color: #ff0000;">JSON.parse() —&gt; string-&gt;json</span></p>
<p><span style="color: #ff0000;">JSON.stringify() —&gt; json-&gt;string</span></p>
<p>通过JSON上的这两个方法，我们就可以进行数据传输了。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">    </span><span class="kwd">var</span><span class="pln"> obj </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><br>2.  <span class="pln">        </span><span class="str">‘name’</span><span class="pun">:</span><span class="pln"> </span><span class="str">‘scarlett’</span><span class="pun">,</span><br>3.  <span class="pln">        </span><span class="str">‘age’</span><span class="pun">:</span><span class="pln"> </span><span class="lit">18</span><br>4.  <span class="pln">    </span><span class="pun">};</span><br>5.  <span class="pln">    </span><span class="kwd">var</span><span class="pln"> </span><span class="kwd">string</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> JSON</span><span class="pun">.</span><span class="pln">stringify</span><span class="pun">(</span><span class="pln">obj</span><span class="pun">);</span><br>6.  <span class="pln">    console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="kwd">string</span><span class="pun">);</span><span class="pln"> </span><span class="com">// ‘{“name”:”scarlett”,”age”:18}’</span><br>7.  <span class="pln">    </span><span class="kwd">var</span><span class="pln"> data </span><span class="pun">=</span><span class="pln"> JSON</span><span class="pun">.</span><span class="pln">parse</span><span class="pun">(</span><span class="kwd">string</span><span class="pun">);</span><br>8.  <span class="pln">    console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">data</span><span class="pun">);</span><span class="pln"> </span><span class="com">// Object {name: “scarlett”, age: 18}</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>• 我们的页面有三个树：DOMTree、CSSTree、renderTree。（实际上多于三个），renderTree上有两个规则：repaint和reflow，重绘和重排。</p>
<p>repaint是元素自身的位置和宽高不变，只改变颜色的之类的属性而不会导致后面的元素位置的变化的时候，renderTree发生的动作。</p>
<p>reflow是元素自身的位置或者宽高改变了从而导致的整个页面的大范围移动的时候，renderTree发生的动作。</p>
<p>所以我们在DOM操作的时候，要<span style="color: #ff0000;">尽量避免重排</span>。</p>
<h3 id="JS异步加载部分"><a href="#JS异步加载部分" class="headerlink" title="JS异步加载部分"></a><span style="color: #ff0000;">JS异步加载部分</span></h3><p>我们前面知道script标签的特点是会阻塞后面的DOM解析，只有当script标签下载完成并且全部执行完之后，浏览器才会继续解析DOM。</p>
<p>这样就导致了js加载有这样的缺点：加载工具方法本身没有必要阻塞文档，js加载会影响整个页面效率，一旦网速不好，那么整个网站将等待js加载而不进行后续渲染。</p>
<p>DOMTree就是解析DOM结构的，当我们在解析DOM的时候突然碰到一个script标签，那么这个script标签就会阻断DOMTree和CSSTree，然而我们有一些js的工具库并不操作DOM，这个时候我们就需要让这些工具库进行异步加载或者按需加载了。</p>
<p>以前有一种写法是将script标签写在body的最后面，等在DOM全部解析完成之后才加载js。</p>
<p>现在有了html5标准之后，就有了另一套异步加载js的方法了。</p>
<p>js异步加载的三种方案：</p>
<p>1.<strong><span style="color: #ff0000;">defer</span></strong>异步加载</p>
<p>我们在script标签的行间写一个defer=“defer”或者直接写defer，就可以让这个script变成异步加载了。但是这种异步只是针对下载方面，<strong><span style="color: #ff0000;">只有等DOMTree全部解析完成（不包括下载完里面的资源）后才会异步执行</span></strong>。而且这个方法只<span style="color: #ff0000;">有IE和一些高版本的firefox和chrome可以用</span>。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="tag">&lt;script</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">“text/javascript”</span><span class="pln"> </span><span class="atn">defer</span><span class="pun">=</span><span class="atv">“defer”</span><span class="tag">&gt;</span><br>3.  <span class="pln">    console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="str">‘hello’</span><span class="pun">);</span><br>4.  <span class="tag">&lt;/script&gt;</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>不过这一种方式<span style="color: #ff0000;">可以在script标签里面写代码</span>。</p>
<p>注意：IE6和IE7的异步加载最多只能有2个，当多余两个的时候必须等前两个加载完才会加载第三个。</p>
<p>所有defer的js代码都<span style="color: #ff0000;">保证按照顺序执行</span>。</p>
<p>2.<strong><span style="color: #ff0000;">async</span></strong>异步加载</p>
<p>async是<strong><span style="color: #ff0000;">asynchronous</span></strong>的缩写，它是html5的标准，<strong><span style="color: #ff0000;">下载完成之后就会立即异步执行</span></strong>，这种方法<span style="color: #ff0000;">除了IE6-IE8其他的浏览器都好用</span>。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="tag">&lt;script</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">“text/javascript”</span><span class="pln"> </span><span class="atn">async</span><span class="pun">=</span><span class="atv">“async”</span><span class="tag">&gt;&lt;/script&gt;</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>不过这种方式<span style="color: #ff0000;">不能把代码写在script标签里面</span>，只能引用。（虽然标准是这么写的，但是现在随着内核升级，async里面也可以写代码了，在没有src的情况下）。</p>
<p>而且async的js代码<span style="color: #ff0000;">不能保证是顺序执行</span>的。</p>
<p>• 这两个属性<span style="color: #ff0000;">不能一起使用</span>！</p>
<p><img src="http://www.flyingliu.com/wp-content/uploads/2016/10/异步js.jpg" alt="%e5%bc%82%e6%ad%a5js"></p>
<p>图中蓝色部分属于js加载过程，红色部分表示js执行过程，绿色代表DOM解析过程。</p>
<p>兼容性写法：</p>
<p>1.直接写两个script标签，一个是defer，一个是async。</p>
<p>但是这种方法有缺陷：IE高版本会加载两遍引起冲突，有些浏览器两个都没有会一个都加载不出来。</p>
<p>所以我们就需要用第二种方法了。</p>
<p>2.通过动态添加script标签。</p>
<p>“Script-inserted script elements now have async default to true, which can be set to false to make the scripts execute in insertion order.”</p>
<p>w3c的标准规定：<strong><span style="color: #ff0000;">动态添加的script标签是异步的</span></strong>。</p>
<p>通过这个特性，我们这里就可以封装一个兼容性的异步加载js的函数了。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">function</span><span class="pln"> asyncLoaded</span><span class="pun">(</span><span class="pln">url</span><span class="pun">,</span><span class="pln"> callback</span><span class="pun">){</span><br>3.  <span class="pln">    </span><span class="kwd">var</span><span class="pln"> script </span><span class="pun">=</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">createElement</span><span class="pun">(</span><span class="str">‘script’</span><span class="pun">);</span><br>4.  <span class="pln">    script</span><span class="pun">.</span><span class="pln">type </span><span class="pun">=</span><span class="pln"> </span><span class="str">‘text/javascript’</span><span class="pun">;</span><br>5.  <span class="pln">    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">script</span><span class="pun">.</span><span class="pln">readyState</span><span class="pun">){</span><span class="com">//IE和高版本的chrome、firefox</span><br>6.  <span class="pln">        script</span><span class="pun">.</span><span class="pln">onreadystatechange </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(){</span><br>7.  <span class="pln">            </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">script</span><span class="pun">.</span><span class="pln">readyState </span><span class="pun">=</span><span class="pln"> </span><span class="str">‘loaded’</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> script</span><span class="pun">.</span><span class="pln">readyState </span><span class="pun">==</span><span class="pln"> </span><span class="str">‘complete’</span><span class="pun">){</span><br>8.  <span class="pln">                script</span><span class="pun">.</span><span class="pln">onreadystatechange </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">;</span><br>9.  <span class="pln">                callback </span><span class="pun">&amp;&amp;</span><span class="pln"> callback</span><span class="pun">();</span><br>10.  <span class="pln">            </span><span class="pun">}</span><br>11.  <span class="pln">        </span><span class="pun">}</span><br>12.  <span class="pln">    </span><span class="pun">}</span><span class="kwd">else</span><span class="pun">{</span><br>13.  <span class="pln">    script</span><span class="pun">.</span><span class="pln">onload </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(</span><span class="pln">e</span><span class="pun">){</span><span class="com">//Safari Chrome Opera Firefox</span><br>14.  <span class="pln">        callback </span><span class="pun">&amp;&amp;</span><span class="pln"> callback</span><span class="pun">();</span><br>15.  <span class="pln">        </span><span class="pun">}</span><br>16.  <span class="pln">    </span><span class="pun">}</span><br>17.  <span class="pln">    script</span><span class="pun">.</span><span class="pln">src </span><span class="pun">=</span><span class="pln"> url</span><span class="pun">;</span><br>18.  <span class="pln">    document</span><span class="pun">.</span><span class="pln">body</span><span class="pun">.</span><span class="pln">appendChild</span><span class="pun">(</span><span class="pln">script</span><span class="pun">);</span><br>19.  <span class="pun">}</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>需要注意的是：readtState的if-else一定要写在script.src=url和appendChild之前，因为电脑速度可能会很快，刚走到src=url部分就已经加载完毕了，readyState已经变成了loaded，后面就不会触发onreadystatechange事件了。</p>
<p>这里src部分的下载是异步的，不会阻塞后面的代码的执行，也就是说可以一边把script插入到DOM中一边下载资源。</p>
<p>还有一点，如果我们的<span style="color: #ff0000;">回调函数是写在需要加载进来的文件里面<span style="color: #000000;">的</span></span>方法的话，我们就需要把这个方法<span style="color: #ff0000;">放到匿名函数里面</span>，这样在语法解析的时候才不会因为函数未声明而报错。</p>
<p>• 异步加载js<strong><span style="color: #ff0000;">不允许使用document.write</span></strong>这个方法。它会清除文档流，一旦执行就会把全部的标签都清除掉，包括自身的script标签。</p>
<h3 id="JS加载时间线（performace-timing-line）"><a href="#JS加载时间线（performace-timing-line）" class="headerlink" title="JS加载时间线（performace timing line）"></a><span style="color: #ff0000;">JS加载时间线（performace timing line）</span></h3><p>1、创建Document对象，开始解析web页面。解析HTML元素和他们的文本内容后添加Element对象和Text节点到文档中。这个阶段document.readyState = ‘loading’。</p>
<p>2、遇到link外部css，创建线程加载，并继续解析文档。</p>
<p>3、遇到script外部js，并且没有设置async、defer，浏览器加载，并阻塞，等待js加载完成并执行该脚本，然后继续解析文档。</p>
<p>4、遇到script外部js，并且设置有async、defer，浏览器创建线程加载，并继续解析文档。 对于async属性的脚本，脚本加载完成后立即执行。（异步禁止使用document.write()）</p>
<p>5、遇到img等，先正常解析dom结构，然后浏览器异步加载src，并继续解析文档。</p>
<p>6、当文档解析完成，document.readyState = ‘interactive’。</p>
<p>7、文档解析完成后，所有设置有defer的脚本会按照顺序执行。（注意与async的不同,</p>
<p>但同样禁止使用document.write()）;</p>
<p>8、document对象触发DOMContentLoaded事件，这也标志着程序执行从同步脚本执行阶段，</p>
<p>转化为事件驱动阶段。</p>
<p>9、当所有async的脚本加载完成并执行后、img等加载完成后，document.readyState = ‘complete’，window</p>
<p>对象触发load事件。</p>
<p>10、从此，以异步响应方式处理用户输入、网络事件等。</p>
<p>JS的时间线是非常重要的知识点，希望大家能背下来这一块哟~</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/01/02/JavaScriptTwenty/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/02/JavaScriptTwenty/" itemprop="url">Web前端的知识之旅哟—— 鼠标事件与键盘事件</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-01-02T17:45:18+08:00">
                2018-01-02
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="鼠标事件"><a href="#鼠标事件" class="headerlink" title="鼠标事件"></a><span style="color: #ff0000;">鼠标事件</span></h3><p>鼠标事件有很多：click、mousedown、mousemove、mouseup、contextmenu、mouseover、mouseout。这些方法的语义化都很好，大家看名字基本都懂是什么意思。</p>
<p>其中，contextmenu是右键出现菜单事件，并不是右键事件。</p>
<p>click是一个完整的点击事件，包括mousedown和mouseup。</p>
<p>mouseover和mouseout是一组事件，对应于鼠标的移入移出事件。</p>
<p>• 所有的鼠标事件都有clientX和clientY，代表的是鼠标点击的位置，我们可以通过e.clientX和e.clentY来查看。</p>
<p>• 左键点击的顺序是：mousedown、mouseup、click</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">var</span><span class="pln"> firstTime</span><span class="pun">,</span><br>3.  <span class="pln">      lastTime</span><span class="pun">,</span><br>4.  <span class="pln">      flag </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">;</span><br>5.  <span class="pln">document</span><span class="pun">.</span><span class="pln">onclick </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">e</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>6.  <span class="pln">    console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="str">‘click’</span><span class="pun">);</span><br>7.  <span class="pun">}</span><br>8.  <span class="pln">document</span><span class="pun">.</span><span class="pln">onmousedown </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">e</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>9.  <span class="pln">    console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="str">‘mousedown’</span><span class="pun">);</span><br>10.  <span class="pun">}</span><br>11.  <span class="pln">document</span><span class="pun">.</span><span class="pln">onmouseup </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">e</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>12.  <span class="pln">    console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="str">‘mouseup’</span><span class="pun">);</span><br>13.  <span class="pun">}</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>输出的结果是mousedown、mouseup、click。</p>
<p>• 当我们同时绑定了click事件和mousedown事件后，如何解决mousedown和click的冲突问题？</p>
<p>其实方法很简单，我们可以通过按下鼠标的事件来判断是执行click还是mousedown事件。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">var</span><span class="pln"> firstTime</span><span class="pun">,</span><br>3.  <span class="pln">      lastTime</span><span class="pun">,</span><br>4.  <span class="pln">      flag </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">;</span><br>5.  <span class="pln">document</span><span class="pun">.</span><span class="pln">onclick </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">e</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>6.  <span class="pln">    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">flag</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>7.  <span class="pln">        console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="str">‘click’</span><span class="pun">);</span><br>8.  <span class="pln">    </span><span class="pun">}</span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><br>9.  <span class="pln">        console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="str">‘mousedown’</span><span class="pun">);</span><br>10.  <span class="pln">    </span><span class="pun">}</span><br>11.  <span class="pun">}</span><br>12.  <span class="pln">document</span><span class="pun">.</span><span class="pln">onmousedown </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">e</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>13.  <span class="pln">    firstTime </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Date</span><span class="pun">().</span><span class="pln">getTime</span><span class="pun">();</span><br>14.  <span class="pun">}</span><br>15.  <span class="pln">document</span><span class="pun">.</span><span class="pln">onmouseup </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">e</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>16.  <span class="pln">    lastTime </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Date</span><span class="pun">().</span><span class="pln">getTime</span><span class="pun">();</span><br>17.  <span class="pln">    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">lastTime </span><span class="pun">-</span><span class="pln"> firstTime </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">200</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>18.  <span class="pln">        flag </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">;</span><br>19.  <span class="pln">    </span><span class="pun">}</span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><br>20.  <span class="pln">        flag </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">;</span><br>21.  <span class="pln">    </span><span class="pun">}</span><br>22.  <span class="pun">}</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>• 如何判断鼠标点击的是左键还是右键？</p>
<p>click事件永远都是左键，有左键和右键的区别的是mousedown事件。</p>
<p>再mousedown的事件对象中有一个属性叫做button，这个属性的值是0的时候代表我们按下的是左键，1的时候代表按下的中键，2的时候代表按下的是右键。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="pln">document</span><span class="pun">.</span><span class="pln">onmousedown </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">e</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>3.  <span class="pln">    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">e</span><span class="pun">.</span><span class="pln">button </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>4.  <span class="pln">        console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="str">‘left’</span><span class="pun">);</span><br>5.  <span class="pln">    </span><span class="pun">}</span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">e</span><span class="pun">.</span><span class="pln">button </span><span class="pun">==</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>6.  <span class="pln">        console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="str">‘mid’</span><span class="pun">);</span><br>7.  <span class="pln">    </span><span class="pun">}</span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><br>8.  <span class="pln">        console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="str">‘right’</span><span class="pun">);</span><br>9.  <span class="pln">    </span><span class="pun">}</span><br>10.  <span class="pun">}</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>这里我们就可以重新回顾一下拖拽事件了：</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">var</span><span class="pln"> div </span><span class="pun">=</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">getElementsByTagName</span><span class="pun">(</span><span class="str">‘div’</span><span class="pun">)[</span><span class="lit">0</span><span class="pun">]</span><br>3.  <span class="kwd">function</span><span class="pln"> drag</span><span class="pun">(</span><span class="pln">elem</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>4.  <span class="pln">    </span><span class="kwd">var</span><span class="pln"> disX</span><span class="pun">,</span><br>5.  <span class="pln">        dixY</span><span class="pun">;</span><br>6.  <span class="pln">    addEvent</span><span class="pun">(</span><span class="pln">elem</span><span class="pun">,</span><span class="pln"> </span><span class="str">‘mousedown’</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">e</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>7.  <span class="pln">        </span><span class="kwd">var</span><span class="pln"> </span><span class="kwd">event</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> e </span><span class="pun">||</span><span class="pln"> window</span><span class="pun">.</span><span class="kwd">event</span><span class="pun">;</span><br>8.  <span class="pln">        disX </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">event</span><span class="pun">.</span><span class="pln">clientX </span><span class="pun">-</span><span class="pln"> parseInt</span><span class="pun">(</span><span class="pln">getStyle</span><span class="pun">(</span><span class="pln">elem</span><span class="pun">,</span><span class="pln"> </span><span class="str">‘left’</span><span class="pun">));</span><br>9.  <span class="pln">        disY </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">event</span><span class="pun">.</span><span class="pln">clientY </span><span class="pun">-</span><span class="pln"> parseInt</span><span class="pun">(</span><span class="pln">getStyle</span><span class="pun">(</span><span class="pln">elem</span><span class="pun">,</span><span class="pln"> </span><span class="str">‘top’</span><span class="pun">));</span><br>10.  <span class="pln">&nbsp;</span><br>11.  <span class="pln">        addEvent</span><span class="pun">(</span><span class="pln">document</span><span class="pun">,</span><span class="pln"> </span><span class="str">‘mousemove’</span><span class="pun">,</span><span class="pln"> mouseMove</span><span class="pun">);</span><br>12.  <span class="pln">        addEvent</span><span class="pun">(</span><span class="pln">document</span><span class="pun">,</span><span class="pln"> </span><span class="str">‘mouseup’</span><span class="pun">,</span><span class="pln"> mouseUp</span><span class="pun">);</span><br>13.  <span class="pln">        stopBubble</span><span class="pun">(</span><span class="pln">e</span><span class="pun">);</span><br>14.  <span class="pln">        cancelHandler</span><span class="pun">(</span><span class="pln">e</span><span class="pun">);</span><br>15.  <span class="pln">    </span><span class="pun">});</span><br>16.  <span class="pln">&nbsp;</span><br>17.  <span class="pln">    </span><span class="kwd">function</span><span class="pln"> mouseMove</span><span class="pun">(</span><span class="pln">e</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>18.  <span class="pln">        </span><span class="kwd">var</span><span class="pln"> </span><span class="kwd">event</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> e </span><span class="pun">||</span><span class="pln"> window</span><span class="pun">.</span><span class="kwd">event</span><span class="pun">;</span><br>19.  <span class="pln">        elem</span><span class="pun">.</span><span class="pln">style</span><span class="pun">.</span><span class="pln">left </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">event</span><span class="pun">.</span><span class="pln">clientX </span><span class="pun">-</span><span class="pln"> disX </span><span class="pun">+</span><span class="pln"> </span><span class="str">‘px’</span><span class="pun">;</span><br>20.  <span class="pln">        elem</span><span class="pun">.</span><span class="pln">style</span><span class="pun">.</span><span class="pln">top </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">event</span><span class="pun">.</span><span class="pln">clientY </span><span class="pun">-</span><span class="pln"> disY </span><span class="pun">+</span><span class="pln"> </span><span class="str">‘px’</span><span class="pun">;</span><br>21.  <span class="pln">    </span><span class="pun">}</span><br>22.  <span class="pln">    </span><span class="kwd">function</span><span class="pln"> mouseUp </span><span class="pun">(</span><span class="pln">e</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>23.  <span class="pln">        removeEvent</span><span class="pun">(</span><span class="pln">document</span><span class="pun">,</span><span class="pln"> </span><span class="str">‘mousemove’</span><span class="pun">,</span><span class="pln"> mouseMove</span><span class="pun">);</span><br>24.  <span class="pln">        removeEvent</span><span class="pun">(</span><span class="pln">document</span><span class="pun">,</span><span class="pln"> </span><span class="str">‘mouseup’</span><span class="pun">,</span><span class="pln"> arguments</span><span class="pun">.</span><span class="pln">callee</span><span class="pun">);</span><br>25.  <span class="pln">    </span><span class="pun">}</span><br>26.  <span class="pun">}</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>这里我们为了不因为鼠标移动过快导致移出div，我们将mouseover事件绑定到了document上。</p>
<p>• 针对鼠标帧频过快的问题，IE中有一个也可以说是另一种事件捕获的方法——domEle.setCapture()。</p>
<p>调用这个方法之后，页面后续的所有操作就会全部都归于这个domEle上，比如div有一个拖拽事件，不过mousemove绑定在div上，只要调用了这个方法，当鼠标拖拽过程中鼠标移出了div，这个时候有效的鼠标移动就变成了document上的mousemove事件了，但是它还是归于了div上，因此div还是可以跟着鼠标移动。</p>
<p>同时还有一个domEle.releaseCapture()方法可以来释放这个捕获行为。</p>
<h3 id="键盘事件"><a href="#键盘事件" class="headerlink" title="键盘事件"></a><span style="color: #ff0000;">键盘事件</span></h3><p>键盘事件主要有三个：keydown、keypress、keyup。</p>
<p>触发顺序分别是keydown、keypress、keyup。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="pln">document</span><span class="pun">.</span><span class="pln">onkeydown </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">e</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>3.  <span class="pln">    console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="str">‘keydown’</span><span class="pun">);</span><br>4.  <span class="pun">}</span><br>5.  <span class="pln">document</span><span class="pun">.</span><span class="pln">onkeypress </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">e</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>6.  <span class="pln">    console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="str">‘keypress’</span><span class="pun">);</span><br>7.  <span class="pun">}</span><br>8.  <span class="pln">document</span><span class="pun">.</span><span class="pln">onkeyup </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">e</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>9.  <span class="pln">    console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="str">‘keyup’</span><span class="pun">);</span><br>10.  <span class="pun">}</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>输出的结果是keydown、keypress、keyup。</p>
<p>keydown和keypress可以响应连续操作，我们一直按着键盘就会一直触发事件。</p>
<p>keypress的范围和keydown有所区别：</p>
<p>keydown可以响应任意键盘按键，keypress只能响应字符类按键，也就是有ASCII码的字符的按键，像字母数字回车空格之类的。</p>
<p>事件对象的属性方面：</p>
<p>只有keypress有charCode属性，这个属性代表的我们输入的这个字符的ASCII码，配合SHIFT之类的按键可以直接获取大写字母等。</p>
<p>keyCode和which每个方法都有，表示的是这个键的唯一标示，可以告诉浏览器我们按下的是键盘上的哪一个键，比如空格是32，32就代表空格。不过我们一般都用which，keyCode用的较少。</p>
<p>• String上有一个方法叫做fromCharCode，可以接受一个Unicode值（包含ASCII值），然后返回对应的字符串，我们可以配合这个方法和charCode来直接获取输入的字符。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="pln">document</span><span class="pun">.</span><span class="pln">onkeypress </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">e</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>3.  <span class="pln">    console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="typ">String</span><span class="pun">.</span><span class="pln">fromCharCode</span><span class="pun">(</span><span class="pln">e</span><span class="pun">.</span><span class="pln">charCode</span><span class="pun">));</span><br>4.  <span class="pun">}</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<h3 id="窗体操作类（window上的事件）"><a href="#窗体操作类（window上的事件）" class="headerlink" title="窗体操作类（window上的事件）"></a><span style="color: #ff0000;">窗体操作类（window上的事件）</span></h3><p><strong><span style="color: #ff0000;">load事件</span></strong></p>
<p>这个事件window.onload和在body标签上写onload是一样的效果，作用是等页面中所有的东西都下载完成再执行里面的代码。</p>
<p><strong><span style="color: #ff0000;">scroll事件</span></strong></p>
<p>这个方法是监听滚轮滚动的事件，我们可以用这个事件来写一个兼容版的fix定位。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">function</span><span class="pln"> beFixed</span><span class="pun">(</span><span class="pln">ele</span><span class="pun">){</span><br>3.  <span class="pln">    </span><span class="kwd">var</span><span class="pln"> initPosX </span><span class="pun">=</span><span class="pln"> ele</span><span class="pun">.</span><span class="pln">getPosition</span><span class="pun">().</span><span class="pln">w</span><span class="pun">,</span><br>4.  <span class="pln">        initPosY </span><span class="pun">=</span><span class="pln"> ele</span><span class="pun">.</span><span class="pln">getPosition</span><span class="pun">().</span><span class="pln">h</span><span class="pun">;</span><br>5.  <span class="pln">    addEvent</span><span class="pun">(</span><span class="pln">window</span><span class="pun">,</span><span class="pln"> </span><span class="str">‘scroll’</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(</span><span class="pln">e</span><span class="pun">){</span><br>6.  <span class="pln">        ele</span><span class="pun">.</span><span class="pln">style</span><span class="pun">.</span><span class="pln">top </span><span class="pun">=</span><span class="pln">  initPosY </span><span class="pun">+</span><span class="pln"> getScrollOffset</span><span class="pun">().</span><span class="pln">h </span><span class="pun">+</span><span class="pln"> </span><span class="str">‘px’</span><span class="pun">;</span><br>7.  <span class="pln">        ele</span><span class="pun">.</span><span class="pln">style</span><span class="pun">.</span><span class="pln">left </span><span class="pun">=</span><span class="pln">  initPosX </span><span class="pun">+</span><span class="pln"> getScrollOffset</span><span class="pun">().</span><span class="pln">w </span><span class="pun">+</span><span class="pln"> </span><span class="str">‘px’</span><span class="pun">;</span><br>8.  <span class="pln">    </span><span class="pun">})</span><br>9.  <span class="pun">}</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/01/02/JavaScriptNineteen/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/02/JavaScriptNineteen/" itemprop="url">Web前端的知识之旅哟—— 事件处理模型与事件委托</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-01-02T17:44:43+08:00">
                2018-01-02
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="事件处理模型——事件冒泡、事件捕获"><a href="#事件处理模型——事件冒泡、事件捕获" class="headerlink" title="事件处理模型——事件冒泡、事件捕获"></a><span style="color: #ff0000;">事件处理模型——事件冒泡、事件捕获</span></h3><p>上一篇介绍了事件的绑定，我们这里先写一个三层div嵌套的结构并且给每一个div都加一个点击事件。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-CSS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="pun">.</span><span class="pln">wrapper </span><span class="pun">{</span><br>3.  <span class="pln">    width</span><span class="pun">:</span><span class="pln"> </span><span class="lit">200px</span><span class="pun">;</span><br>4.  <span class="pln">    height</span><span class="pun">:</span><span class="pln"> </span><span class="lit">200px</span><span class="pun">;</span><br>5.  <span class="pln">    background</span><span class="pun">-</span><span class="pln">color</span><span class="pun">:</span><span class="pln"> red</span><span class="pun">;</span><br>6.  <span class="pun">}</span><br>7.  <span class="pun">.</span><span class="pln">box </span><span class="pun">{</span><br>8.  <span class="pln">    width</span><span class="pun">:</span><span class="pln"> </span><span class="lit">100px</span><span class="pun">;</span><br>9.  <span class="pln">    height</span><span class="pun">:</span><span class="pln"> </span><span class="lit">100px</span><span class="pun">;</span><br>10.  <span class="pln">    background</span><span class="pun">-</span><span class="pln">color</span><span class="pun">:</span><span class="pln"> green</span><span class="pun">;</span><br>11.  <span class="pun">}</span><br>12.  <span class="pln">&nbsp;</span><br>13.  <span class="pun">.</span><span class="pln">content </span><span class="pun">{</span><br>14.  <span class="pln">    width</span><span class="pun">:</span><span class="pln"> </span><span class="lit">50px</span><span class="pun">;</span><br>15.  <span class="pln">    height</span><span class="pun">:</span><span class="pln"> </span><span class="lit">50px</span><span class="pun">;</span><br>16.  <span class="pln">    background</span><span class="pun">-</span><span class="pln">color</span><span class="pun">:</span><span class="pln"> black</span><span class="pun">;</span><br>17.  <span class="pun">}</span><br>18.  <span class="pln">&nbsp;</span></pre><div class="code-pretty-toolbar"><span class="title">CSS</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p><img src="http://www.flyingliu.com/wp-content/uploads/2016/10/1.png" alt="1"></p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">var</span><span class="pln"> wrapper </span><span class="pun">=</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">getElementsByClassName</span><span class="pun">(</span><span class="str">‘wrapper’</span><span class="pun">)[</span><span class="lit">0</span><span class="pun">],</span><br>3.  <span class="pln">    box </span><span class="pun">=</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">getElementsByClassName</span><span class="pun">(</span><span class="str">‘box’</span><span class="pun">)[</span><span class="lit">0</span><span class="pun">],</span><br>4.  <span class="pln">    content </span><span class="pun">=</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">getElementsByClassName</span><span class="pun">(</span><span class="str">‘content’</span><span class="pun">)[</span><span class="lit">0</span><span class="pun">];</span><br>5.  <span class="pln">wrapper</span><span class="pun">.</span><span class="pln">onclick </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><br>6.  <span class="pln">    console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="str">‘wrapper’</span><span class="pun">);</span><br>7.  <span class="pun">}</span><br>8.  <span class="pln">box</span><span class="pun">.</span><span class="pln">onclick </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><br>9.  <span class="pln">    console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="str">‘box’</span><span class="pun">);</span><br>10.  <span class="pun">}</span><br>11.  <span class="pln">content</span><span class="pun">.</span><span class="pln">onclick </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><br>12.  <span class="pln">    console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="str">‘content’</span><span class="pun">);</span><br>13.  <span class="pun">}</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>现在我们点击最外层的wrapper，控制台打印的wrapper。</p>
<p>点击box，却打印出来box和wrapper</p>
<p>点击content打印出来content、box、wrapper</p>
<p>这个现象就是我们所说的事件冒泡。</p>
<p>什么叫冒泡？</p>
<p>在<strong><span style="color: #ff0000;">结构上</span></strong>（非视觉上）嵌套关系的元素，会存在事件冒泡的功能，即同一事件，<span style="color: #ff0000;">子元素冒泡向父元素</span>，结构上的自底向上。（这里的底是结构上的底，视觉上是自顶向下）</p>
<p>大部分事件都有事件冒泡现象，并且<span style="color: #ff0000;">所有的浏览器都有事件冒泡</span>。</p>
<p>结构上的冒泡，和视觉的位置没有关系，我们看一下三个方块视觉上分开的例子：</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-CSS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="pun">.</span><span class="pln">wrapper </span><span class="pun">{</span><br>3.  <span class="pln">        width</span><span class="pun">:</span><span class="pln"> </span><span class="lit">200px</span><span class="pun">;</span><br>4.  <span class="pln">        height</span><span class="pun">:</span><span class="pln"> </span><span class="lit">200px</span><span class="pun">;</span><br>5.  <span class="pln">        background</span><span class="pun">-</span><span class="pln">color</span><span class="pun">:</span><span class="pln"> red</span><span class="pun">;</span><br>6.  <span class="pln">        position</span><span class="pun">:</span><span class="pln"> absolute</span><span class="pun">;</span><br>7.  <span class="pln">    </span><span class="pun">}</span><br>8.  <span class="pln">    </span><span class="pun">.</span><span class="pln">box </span><span class="pun">{</span><br>9.  <span class="pln">        width</span><span class="pun">:</span><span class="pln"> </span><span class="lit">100px</span><span class="pun">;</span><br>10.  <span class="pln">        height</span><span class="pun">:</span><span class="pln"> </span><span class="lit">100px</span><span class="pun">;</span><br>11.  <span class="pln">        background</span><span class="pun">-</span><span class="pln">color</span><span class="pun">:</span><span class="pln"> green</span><span class="pun">;</span><br>12.  <span class="pln">        position</span><span class="pun">:</span><span class="pln"> absolute</span><span class="pun">;</span><br>13.  <span class="pln">        left</span><span class="pun">:</span><span class="pln"> </span><span class="lit">200px</span><span class="pun">;</span><br>14.  <span class="pln">        top</span><span class="pun">:</span><span class="pln"> </span><span class="lit">200px</span><span class="pun">;</span><br>15.  <span class="pln">    </span><span class="pun">}</span><br>16.  <span class="pln">&nbsp;</span><br>17.  <span class="pln">    </span><span class="pun">.</span><span class="pln">content </span><span class="pun">{</span><br>18.  <span class="pln">        width</span><span class="pun">:</span><span class="pln"> </span><span class="lit">50px</span><span class="pun">;</span><br>19.  <span class="pln">        height</span><span class="pun">:</span><span class="pln"> </span><span class="lit">50px</span><span class="pun">;</span><br>20.  <span class="pln">        background</span><span class="pun">-</span><span class="pln">color</span><span class="pun">:</span><span class="pln"> black</span><span class="pun">;</span><br>21.  <span class="pln">        position</span><span class="pun">:</span><span class="pln"> absolute</span><span class="pun">;</span><br>22.  <span class="pln">        left</span><span class="pun">:</span><span class="pln"> </span><span class="lit">100px</span><span class="pun">;</span><br>23.  <span class="pln">        top</span><span class="pun">:</span><span class="pln"> </span><span class="lit">100px</span><span class="pun">;</span><br>24.  <span class="pln">    </span><span class="pun">}</span></pre><div class="code-pretty-toolbar"><span class="title">CSS</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p><img src="http://www.flyingliu.com/wp-content/uploads/2016/10/2-298x300.png" alt="2"></p>
<p>我们点击content部分之后依然会把box和wrapper都打印出来。</p>
<p><span style="color: #ff0000;">并不是所有的事件都有冒泡</span>，focus、blur、change、submit、reset、select等方法就没有事件冒泡现象。</p>
<p>事件捕获：</p>
<p><strong><span style="color: #ff0000;">结构上</span></strong>（非视觉上）嵌套关系的元素，会存在事件捕获功能，即同一事件，<span style="color: #ff0000;">自父元素捕获至子元素</span>（事件源元素），结构上的自顶向下。</p>
<p>addEventListener最后一个参数就是是否开始事件捕获，当我们填true的时候，就代表开启了事件捕获。只要开启了事件捕获，就不会冒泡了，如果不捕获的话，就遵循事件冒泡。</p>
<p>因为addEventListener只有chrome有，因此<span style="color: #ff0000;">事件捕获也只有chrome浏览器有</span>。</p>
<p>依然是上面的那个例子：</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">var</span><span class="pln"> wrapper </span><span class="pun">=</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">getElementsByClassName</span><span class="pun">(</span><span class="str">‘wrapper’</span><span class="pun">)[</span><span class="lit">0</span><span class="pun">],</span><br>3.  <span class="pln">    box </span><span class="pun">=</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">getElementsByClassName</span><span class="pun">(</span><span class="str">‘box’</span><span class="pun">)[</span><span class="lit">0</span><span class="pun">],</span><br>4.  <span class="pln">    content </span><span class="pun">=</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">getElementsByClassName</span><span class="pun">(</span><span class="str">‘content’</span><span class="pun">)[</span><span class="lit">0</span><span class="pun">];</span><br>5.  <span class="pln">wrapper</span><span class="pun">.</span><span class="pln">addEventListener</span><span class="pun">(</span><span class="str">‘click’</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">e</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>6.  <span class="pln">    console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="str">‘wrapper’</span><span class="pun">);</span><br>7.  <span class="pun">},</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">);</span><br>8.  <span class="pln">box</span><span class="pun">.</span><span class="pln">addEventListener</span><span class="pun">(</span><span class="str">‘click’</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">e</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>9.  <span class="pln">    console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="str">‘box’</span><span class="pun">);</span><br>10.  <span class="pun">},</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">);</span><br>11.  <span class="pln">content</span><span class="pun">.</span><span class="pln">addEventListener</span><span class="pun">(</span><span class="str">‘click’</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">e</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>12.  <span class="pln">    console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="str">‘content’</span><span class="pun">);</span><br>13.  <span class="pun">},</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">);</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>现在点击content之后，顺序是wrapper、box、content。</p>
<p>当事件冒泡和事件捕获同时存在的时候，事件冒泡和事件捕获的触发顺序则为：<strong><span style="color: #ff0000;">先捕获，再冒泡</span></strong>。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">var</span><span class="pln"> wrapper </span><span class="pun">=</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">getElementsByClassName</span><span class="pun">(</span><span class="str">‘wrapper’</span><span class="pun">)[</span><span class="lit">0</span><span class="pun">],</span><br>3.  <span class="pln">    box </span><span class="pun">=</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">getElementsByClassName</span><span class="pun">(</span><span class="str">‘box’</span><span class="pun">)[</span><span class="lit">0</span><span class="pun">],</span><br>4.  <span class="pln">    content </span><span class="pun">=</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">getElementsByClassName</span><span class="pun">(</span><span class="str">‘content’</span><span class="pun">)[</span><span class="lit">0</span><span class="pun">];</span><br>5.  <span class="pln">wrapper</span><span class="pun">.</span><span class="pln">onclick </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><br>6.  <span class="pln">    console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="str">‘wrappeBubbler’</span><span class="pun">);</span><br>7.  <span class="pun">}</span><br>8.  <span class="pln">box</span><span class="pun">.</span><span class="pln">onclick </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><br>9.  <span class="pln">    console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="str">‘boxBubble’</span><span class="pun">);</span><br>10.  <span class="pun">}</span><br>11.  <span class="pln">content</span><span class="pun">.</span><span class="pln">onclick </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><br>12.  <span class="pln">    console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="str">‘contentBubble’</span><span class="pun">);</span><br>13.  <span class="pun">}</span><br>14.  <span class="pln">wrapper</span><span class="pun">.</span><span class="pln">addEventListener</span><span class="pun">(</span><span class="str">‘click’</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">e</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>15.  <span class="pln">    console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="str">‘wrapper’</span><span class="pun">);</span><br>16.  <span class="pun">},</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">);</span><br>17.  <span class="pln">box</span><span class="pun">.</span><span class="pln">addEventListener</span><span class="pun">(</span><span class="str">‘click’</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">e</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>18.  <span class="pln">    console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="str">‘box’</span><span class="pun">);</span><br>19.  <span class="pun">},</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">);</span><br>20.  <span class="pln">content</span><span class="pun">.</span><span class="pln">addEventListener</span><span class="pun">(</span><span class="str">‘click’</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">e</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>21.  <span class="pln">    console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="str">‘content’</span><span class="pun">);</span><br>22.  <span class="pun">},</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">);</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>结果是先捕获再冒泡。</p>
<p>但是当我们把捕获写到冒泡前面的时候，顺序好像发生了变化。</p>
<p>wrapper–&gt;box–&gt;<span style="color: #ff0000;">contentBubble</span>–&gt;content–&gt;boxBubble–&gt;wrapperBubble</p>
<p>这里是因为点击content，并不属于冒泡，而是属于<span style="color: #ff0000;">事件执行</span>，我们先绑定的boxBubble，所以就先捕获，再事件执行，再冒泡，这与我们的结论没有冲突。</p>
<h3 id="取消冒泡和阻止默认事件"><a href="#取消冒泡和阻止默认事件" class="headerlink" title="取消冒泡和阻止默认事件"></a><span style="color: #ff0000;">取消冒泡和阻止默认事件</span></h3><p>有时候冒泡或者默认事件会对我们的功能造成影响，因此我们需要适时地取消冒泡和默认事件。</p>
<p>我们绑定事件的处理函数的时候，可以传递一个形参，代表我们的事件对象，一般是e或者event，<span style="color: #ff0000;">系统会自动帮我们捕获事件源对象并且把事件源对象传入</span>。</p>
<p><strong><span style="color: #ff0000;">取消冒</span><span style="color: #ff0000;">泡</span><span style="color: #ff0000;">的方法</span></strong></p>
<p>1.<strong><span style="color: #ff0000;">w3c标准方法：event.stopPropagation()</span></strong></p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">var</span><span class="pln"> wrapper </span><span class="pun">=</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">getElementsByClassName</span><span class="pun">(</span><span class="str">‘wrapper’</span><span class="pun">)[</span><span class="lit">0</span><span class="pun">],</span><br>3.  <span class="pln">    box </span><span class="pun">=</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">getElementsByClassName</span><span class="pun">(</span><span class="str">‘box’</span><span class="pun">)[</span><span class="lit">0</span><span class="pun">],</span><br>4.  <span class="pln">    content </span><span class="pun">=</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">getElementsByClassName</span><span class="pun">(</span><span class="str">‘content’</span><span class="pun">)[</span><span class="lit">0</span><span class="pun">];</span><br>5.  <span class="pln">content</span><span class="pun">.</span><span class="pln">onclick </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">e</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>6.  <span class="pln">    console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="str">‘content’</span><span class="pun">);</span><br>7.  <span class="pln">    e</span><span class="pun">.</span><span class="pln">stopPropagation</span><span class="pun">();</span><br>8.  <span class="pun">}</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>现在我们点击content之后就没有冒泡了，但是点击box还是有冒泡的，因为我们没有取消box的冒泡。</p>
<p>I<strong><span style="color: #ff0000;">E9以及以下的版本不支持这个方法</span></strong>。</p>
<p>2.<strong><span style="color: #ff0000;">event.cancelBubble = true</span></strong></p>
<p>这个属性是IE的，不过一些高版本的浏览器也有这个属性，只要让这个属性的值等于true，同样也可以取消事件冒泡。</p>
<p>封装一个兼容性的取消事件冒泡的方法：</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="pln">&nbsp;</span><br>3.  <span class="kwd">function</span><span class="pln"> stopBubble</span><span class="pun">(</span><span class="kwd">event</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>4.  <span class="pln">    </span><span class="kwd">if</span><span class="pun">(</span><span class="kwd">event</span><span class="pun">.</span><span class="pln">stopPropagation</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>5.  <span class="pln">        </span><span class="kwd">event</span><span class="pun">.</span><span class="pln">stopPropagation</span><span class="pun">();</span><br>6.  <span class="pln">    </span><span class="pun">}</span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><br>7.  <span class="pln">        </span><span class="kwd">event</span><span class="pun">.</span><span class="pln">cancelBubble </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">;</span><br>8.  <span class="pln">    </span><span class="pun">}</span><br>9.  <span class="pun">}</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p><strong><span style="color: #ff0000;">默认事件</span></strong></p>
<p>当我们在浏览器中点击右键，会弹出一个菜单，这就是一个默认事件contextmenu。还有a标签，即使我们不写跳转的页面，也会自动刷新页面，这也是一个默认事件。</p>
<p>移动端的默认事件更多。</p>
<p>默认事件有好的也有不好的，这就需要我们把不需要的默认事件阻止掉。</p>
<p><strong><span style="color: #ff0000;">阻止默认事件</span></strong></p>
<p>1.<strong><span style="color: #ff0000;">return false</span></strong></p>
<p>我们只要在处理函数最后写上 return false就可以阻止默认事件了。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="pln">document</span><span class="pun">.</span><span class="pln">oncontextmenu </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><br>3.  <span class="pln">    console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="str">‘menu’</span><span class="pun">);</span><br>4.  <span class="pln">    </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">;</span><br>5.  <span class="pun">}</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>现在我们在页面上右键就不会出现菜单了。</p>
<p>不过要注意的是，<span style="color: #ff0000;">这种写法只能用在<strong>句柄方式</strong>绑定的事件上</span>。</p>
<p>2.<strong><span style="color: #ff0000;">e.preventDefault()</span></strong></p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="pln">documet</span><span class="pun">.</span><span class="pln">addEventListener</span><span class="pun">(</span><span class="str">‘contextmenu’</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">e</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>3.  <span class="pln">    console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="str">‘menu’</span><span class="pun">);</span><br>4.  <span class="pln">    e</span><span class="pun">.</span><span class="pln">preventDefault</span><span class="pun">();</span><br>5.  <span class="pun">},</span><span class="kwd">false</span><span class="pun">);</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>这是w3c标准的阻止默认事件的方法，句柄也同样可以使用。</p>
<p>不过<strong><span style="color: #ff0000;">IE9以下不兼容</span></strong>。</p>
<p>3.<strong><span style="color: #ff0000;">e.returnValue = false</span></strong></p>
<p>这个是<strong><span style="color: #ff0000;">IE</span></strong>的方法，事件源对象上的属性returnValue代表是否有默认事件，直接返回false就可以阻止默认事件了。现在高版本的浏览器也有这个属性。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="pln">document</span><span class="pun">.</span><span class="pln">attachEvent</span><span class="pun">(</span><span class="str">‘oncontextmenu’</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">e</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>3.  <span class="pln">    e</span><span class="pun">.</span><span class="pln">returnValue </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">;</span><br>4.  <span class="pun">});</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>现在我们也可以封装一个兼容性的阻止默认事件的方法了：</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">function</span><span class="pln"> cancelHandler</span><span class="pun">(</span><span class="kwd">event</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>3.  <span class="pln">    </span><span class="kwd">if</span><span class="pun">(</span><span class="kwd">event</span><span class="pun">.</span><span class="pln">preventDefault</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>4.  <span class="pln">        </span><span class="kwd">event</span><span class="pun">.</span><span class="pln">preventDefault</span><span class="pun">();</span><br>5.  <span class="pln">    </span><span class="pun">}</span><span class="kwd">else</span><span class="pun">{</span><br>6.  <span class="pln">        </span><span class="kwd">event</span><span class="pun">.</span><span class="pln">returnValue </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">;</span><br>7.  <span class="pln">    </span><span class="pun">}</span><br>8.  <span class="pun">}</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>小例子：阻止a标签不跳转</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">var</span><span class="pln"> a </span><span class="pun">=</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">links</span><span class="pun">[</span><span class="lit">0</span><span class="pun">];</span><br>3.  <span class="pln">a</span><span class="pun">.</span><span class="pln">addEventListener</span><span class="pun">(</span><span class="str">‘click’</span><span class="pun">,</span><span class="pln"> funciton </span><span class="pun">(</span><span class="pln">e</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>4.  <span class="pln">    e</span><span class="pun">.</span><span class="pln">cancelHandler</span><span class="pun">(</span><span class="pln">e</span><span class="pun">);</span><br>5.  <span class="pun">},</span><span class="kwd">false</span><span class="pun">);</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>这样a标签就不会跳转了。</p>
<p>同时我们还可以用a标签的第四个用处，协议限定符来阻止默认事件。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="tag">&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">“javascript: void(0); “</span><span class="tag">&gt;</span><span class="pln">www.baidu.com</span><span class="tag">&lt;/a&gt;</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>不仅仅是0，只要填写一个代表false的值，就可以取消掉默认事件。</p>
<h3 id="事件对象"><a href="#事件对象" class="headerlink" title="事件对象"></a><span style="color: #ff0000;">事件对象</span></h3><p><span style="color: #ff0000;">在IE中，系统不会把事件对象传到方法中，因此我们的参数e或者event在IE中是不好用的，IE会把事件对象传递到window.event上</span>，所以当我们使用事件对象的时候，就要写兼容性的写法：</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">var</span><span class="pln"> </span><span class="kwd">event</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> e </span><span class="pun">||</span><span class="pln"> window</span><span class="pun">.</span><span class="kwd">event</span><span class="pun">;</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>这样就可以正常地获取到事件对象了。</p>
<h3 id="事件委托"><a href="#事件委托" class="headerlink" title="事件委托"></a><span style="color: #ff0000;">事件委托</span></h3><p><span style="color: #ff0000;"><strong>事件源对象</strong></span></p>
<p>我们现在有一个ul，下面有十万个li，当我们给父级的ul添加第一个点击事件之后，由于<strong><span style="color: #ff0000;">事件冒泡</span></strong>的存在，不论我们点击哪一个li都会调用父级的点击事件处理函数，这个时候触发父级ul的点击函数的那个li就被称之为事件源对象。</p>
<p><strong><span style="color: #ff0000;">event.target</span> </strong>是<span style="color: #ff0000;">火狐</span>的获取事件源对象</p>
<p><strong><span style="color: #ff0000;">event.srcElement</span> </strong>是<span style="color: #ff0000;">IE</span>的获取事件源对象</p>
<p>chrome两种都有</p>
<p>因此我们在获取事件源对象的时候也需要写兼容性写法， 配合刚才的事件对象的兼容性写法就是这个样子的：</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="pln">oUl</span><span class="pun">.</span><span class="pln">addEventListener</span><span class="pun">(</span><span class="str">‘click’</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">e</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>3.  <span class="pln">    </span><span class="kwd">var</span><span class="pln"> </span><span class="kwd">event</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> e </span><span class="pun">||</span><span class="pln"> window</span><span class="pun">.</span><span class="kwd">event</span><span class="pun">;</span><br>4.  <span class="pln">    </span><span class="kwd">var</span><span class="pln"> tar </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">event</span><span class="pun">.</span><span class="pln">target </span><span class="pun">||</span><span class="pln"> </span><span class="kwd">event</span><span class="pun">.</span><span class="pln">srcElement</span><span class="pun">;</span><br>5.  <span class="pln">        console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">tar</span><span class="pun">);</span><br>6.  <span class="pln">    </span><span class="pun">},</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">);</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>我们<span style="color: #ff0000;">利用事件源对象和事件冒泡来处理的方式就叫做事件委托</span>。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="pln">oUl</span><span class="pun">.</span><span class="pln">addEventListener</span><span class="pun">(</span><span class="str">‘click’</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">e</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>3.  <span class="pln">    </span><span class="kwd">var</span><span class="pln"> </span><span class="kwd">event</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> e </span><span class="pun">||</span><span class="pln"> window</span><span class="pun">.</span><span class="kwd">event</span><span class="pun">;</span><br>4.  <span class="pln">    </span><span class="kwd">var</span><span class="pln"> tar </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">event</span><span class="pun">.</span><span class="pln">target </span><span class="pun">||</span><span class="pln"> </span><span class="kwd">event</span><span class="pun">.</span><span class="pln">srcElement</span><span class="pun">;</span><br>5.  <span class="pln">    console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">tar</span><span class="pun">.</span><span class="pln">innerHTML</span><span class="pun">);</span><br>6.  <span class="pln">    </span><span class="pun">},</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">);</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>事件委托的<span style="color: #ff0000;">优点</span>：</p>
<p>1.<span style="color: #ff0000;">性能</span> 不需要循环所有的子元素一个个绑定事件</p>
<p>2.<span style="color: #ff0000;">灵活</span> 当有新的子元素被加入的时候不需要重新绑定事件</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/01/02/JavaScriptEightteen/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/02/JavaScriptEightteen/" itemprop="url">JWeb前端的知识之旅哟—— 事件的绑定与解除</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-01-02T17:44:33+08:00">
                2018-01-02
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>事件是<span style="color: #ff0000;">交互体验的核心功能</span>，非常非常重要。</p>
<p>事件是每一个浏览器本来就有的，我们只是给相应的事件添加了一个<span style="color: #ff0000;">回调函数</span>。</p>
<p>下面先看一个拖拽事件的例子来感受一下事件：</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br><br>1.  <span class="pln">div</span><span class="pun">.</span><span class="pln">addEventListener</span><span class="pun">(</span><span class="str">‘mousedown’</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">e</span><span class="pun">){</span><br>2.  <span class="kwd">var</span><span class="pln"> disX </span><span class="pun">=</span><span class="pln"> e</span><span class="pun">.</span><span class="pln">clientX </span><span class="pun">-</span><span class="pln"> parseInt</span><span class="pun">(</span><span class="pln">getStyle</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">,</span><span class="pln"> </span><span class="str">‘left’</span><span class="pun">)),</span><br>3.  <span class="pln">    disY </span><span class="pun">=</span><span class="pln"> e</span><span class="pun">.</span><span class="pln">clientY </span><span class="pun">-</span><span class="pln"> parseInt</span><span class="pun">(</span><span class="pln">getStyle</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">,</span><span class="pln"> </span><span class="str">‘top’</span><span class="pun">));</span><br>4.  <span class="pln">document</span><span class="pun">.</span><span class="pln">addEventListener</span><span class="pun">(</span><span class="str">‘mousemove’</span><span class="pun">,</span><span class="pln"> mouseMove</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">);</span><br>5.  <span class="pln">    div</span><span class="pun">.</span><span class="pln">addEventListener</span><span class="pun">(</span><span class="str">‘mouseup’</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">e</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>6.  <span class="pln">        document</span><span class="pun">.</span><span class="pln">removeEventListener</span><span class="pun">(</span><span class="str">‘mousemove’</span><span class="pun">,</span><span class="pln"> mouseMove</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">);</span><br>7.  <span class="pln">    </span><span class="pun">},</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">);</span><br>8.  <span class="pun">},</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">);</span><br>9.  <span class="pln">&nbsp;</span><br>10.  <span class="kwd">function</span><span class="pln"> mouseMove</span><span class="pun">(</span><span class="pln">e</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>11.  <span class="pln">      div</span><span class="pun">.</span><span class="pln">style</span><span class="pun">.</span><span class="pln">left </span><span class="pun">=</span><span class="pln"> e</span><span class="pun">.</span><span class="pln">clentX </span><span class="pun">-</span><span class="pln"> disX </span><span class="pun">+</span><span class="pln"> </span><span class="str">‘px’</span><span class="pun">;</span><br>12.  <span class="pln">      div</span><span class="pun">.</span><span class="pln">style</span><span class="pun">.</span><span class="pln">top </span><span class="pun">=</span><span class="pln"> e</span><span class="pun">.</span><span class="pln">clientY </span><span class="pun">-</span><span class="pln"> disY </span><span class="pun">+</span><span class="pln"> </span><span class="str">‘px’</span><span class="pun">;</span><br>13.  <span class="pln">&nbsp;</span><br>14.  <span class="pun">}</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>我们首先看一下如何绑定事件，这里我们以点击事件为例。</p>
<h3 id="绑定事件"><a href="#绑定事件" class="headerlink" title="绑定事件"></a><span style="color: #ff0000;">绑定事件</span></h3><p>1.<strong><span style="color: #ff0000;">句柄方式</span></strong></p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br><br>1.  <span class="kwd">var</span><span class="pln"> div </span><span class="pun">=</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">getElementsByTagName</span><span class="pun">(</span><span class="str">‘div’</span><span class="pun">)[</span><span class="lit">0</span><span class="pun">];</span><br>2.  <span class="pln">div</span><span class="pun">.</span><span class="pln">onclick </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">e</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>3.  <span class="pln">      console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="str">‘a’</span><span class="pun">);</span><br>4.  <span class="pun">}</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>后面的这个函数就叫做<span style="color: #ff0000;">事件处理函数</span>，也称回调函数，当我们点击事件触发的时候，就会执行后面的处理函数。</p>
<p>事件可以持续监听，并不是执行完一次就失效，因此这个事件监听部分并不属于js引擎，因为js引擎是单线程的，<span style="color: #ff0000;">事件监听属于内核的其他模块部分</span>，一旦事件触发，事件监听就会把处理函数放入<span style="color: #ff0000;">执行队列</span>，等待js引擎来执行。</p>
<p><span style="color: #ff0000;">虽然句柄方式的兼容性很好，但是一个元素的一种事件只能绑定一个函数</span>。</p>
<p>基本等同于写在行间的事件。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br><br>1.  <span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">onclick</span><span class="pun">=</span><span class="atv">“</span><span class="pln">console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="str">‘a’</span><span class="pun">)</span><span class="atv">“</span><span class="tag">&gt;&lt;/div&gt;</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>这两种写法是一致的。</p>
<p>一些比较简单的函数可以用这种方式来写。</p>
<p>2.ele.addEventListener(type, handle, false)方法。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br><br>1.  <span class="pln">div</span><span class="pun">.</span><span class="pln">addEventListener</span><span class="pun">(</span><span class="str">‘click’</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(</span><span class="pln">e</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>2.  <span class="pln">      console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="str">‘a’</span><span class="pun">);</span><br>3.  <span class="pun">},</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">);</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>这里面有三个参数，第一个参数是事件类型，第二个参数是处理函数，第三个参数是是否捕获。</p>
<p>处理函数可以直接在addEventListener方法里面写一个匿名函数，也可以在外面写一个命名函数，然后在放法里面写函数的引用。</p>
<p>这种方法更加通用常见，而且<span style="color: #ff0000;">一种事件可以绑定多个函数，但是同一个处理函数只能绑定一次</span>。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">function</span><span class="pln"> test1 </span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><br>3.  <span class="pln">      console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="str">‘a’</span><span class="pun">);</span><br>4.  <span class="pun">}</span><br>5.  <span class="kwd">function</span><span class="pln"> test2</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><br>6.  <span class="pln">      console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="str">‘a’</span><span class="pun">);</span><br>7.  <span class="pun">}</span><br>8.  <span class="pln">div</span><span class="pun">.</span><span class="pln">addEventListener</span><span class="pun">(</span><span class="str">‘click’</span><span class="pun">,</span><span class="pln"> test1</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">);</span><br>9.  <span class="pln">div</span><span class="pun">.</span><span class="pln">addEventListener</span><span class="pun">(</span><span class="str">‘click’</span><span class="pun">,</span><span class="pln"> test2</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">);</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>点击一次同时打印a和b。</p>
<p>• <strong><span style="color: #ff0000;">这是唯一一个有事件捕获的方法。</span></strong></p>
<p><span style="color: #ff0000;">注意</span>：即使函数体相同，两个函数也不是一个函数。</p>
<p>不过很遗憾的是，这种方法在<strong><span style="color: #ff0000;">IE9以下不兼容</span></strong>。</p>
<p>3.ele.attachEvent(‘on’ + type, handle)</p>
<p>这个方法是IE独有的方法，<span style="color: #ff0000;">一个事件同样可以绑定多个处理函数</span>。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="pln">div</span><span class="pun">.</span><span class="pln">attachEvent</span><span class="pun">(</span><span class="str">‘onclick’</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(){</span><br>3.  <span class="pln">      console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="str">‘a’</span><span class="pun">);</span><br>4.  <span class="pun">});</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>基本和addEventListener差不多，但是有一点区别是，<span style="color: #ff0000;">当同一个函数绑定多次的时候，addEventListener是只执行一次，但是attachEvent会绑定几次执行几次</span>。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">function</span><span class="pln"> test </span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><br>3.  <span class="pln">      console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="str">‘a’</span><span class="pun">);</span><br>4.  <span class="pun">}</span><br>5.  <span class="pln">div</span><span class="pun">.</span><span class="pln">attachEvent</span><span class="pun">(</span><span class="str">‘onclick’</span><span class="pun">,</span><span class="pln"> test</span><span class="pun">);</span><br>6.  <span class="pln">div</span><span class="pun">.</span><span class="pln">attachEvent</span><span class="pun">(</span><span class="str">‘onclick’</span><span class="pun">,</span><span class="pln"> test</span><span class="pun">);</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>现在点击一次会打印两个a。</p>
<p>现在这里有一个笔试常考的绑定事件的题：使用原生js，addEventListener，为每一个li绑定一个点击事件，输出他们的顺序。</p>
<p>这里就要注意这个题考察的不仅仅是绑定事件，更多的是<span style="color: #ff0000;">闭包</span>的运用。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="pln">    </span><span class="kwd">var</span><span class="pln"> $Li </span><span class="pun">=</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">getElementsByTagName</span><span class="pun">(</span><span class="str">‘li’</span><span class="pun">);</span><br>3.  <span class="pln">    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">var</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> len </span><span class="pun">=</span><span class="pln"> $Li</span><span class="pun">.</span><span class="pln">length</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> len</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><br>4.  <span class="pln">    </span><span class="pun">(</span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>5.  <span class="pln">          $Li</span><span class="pun">[</span><span class="pln">n</span><span class="pun">].</span><span class="pln">addEventListener</span><span class="pun">(</span><span class="str">‘click’</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><br>6.  <span class="pln">                console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">n</span><span class="pun">);</span><br>7.  <span class="pln">          </span><span class="pun">},</span><span class="kwd">false</span><span class="pun">);</span><br>8.  <span class="pln">    </span><span class="pun">}</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i</span><span class="pun">))</span><br>9.  <span class="pun">}</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<h3 id="事件处理程序的运行环境"><a href="#事件处理程序的运行环境" class="headerlink" title="事件处理程序的运行环境"></a><span style="color: #ff0000;">事件处理程序的运行环境</span></h3><p>1.句柄绑定方式中，函数里面的<span style="color: #ff0000;">this指向元素本身</span>。</p>
<p>2.addEventListener方式中，函数里面的<span style="color: #ff0000;">this也是指向元素本身</span>。</p>
<p>3.attachEvent中，函数里面的<span style="color: #ff0000;">this指向的是<strong>window</strong>而不是元素本身</span>，这算是IE的一个BUG。针对这种情况，我们就需要把函数提取出来，然后在attachEvent的时候用<span style="color: #ff0000;">call</span>来改变函数内部this的指向。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br><br>1.  <span class="pln">div</span><span class="pun">.</span><span class="pln">attachEvent</span><span class="pun">(</span><span class="str">‘onclick’</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><br>2.  <span class="pln">      test</span><span class="pun">.</span><span class="pln">call</span><span class="pun">(</span><span class="pln">div</span><span class="pun">);</span><br>3.  <span class="pun">},</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">);</span><br>4.  <span class="pln">&nbsp;</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>有了以上的知识，我们就可以封装一个兼容性的事件绑定函数了。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="pln">    </span><span class="kwd">function</span><span class="pln"> attachEvent</span><span class="pun">(</span><span class="pln">ele</span><span class="pun">,</span><span class="pln"> type</span><span class="pun">,</span><span class="pln"> handle</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>3.  <span class="pln">        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ele</span><span class="pun">.</span><span class="pln">addEventListener</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>4.  <span class="pln">            ele</span><span class="pun">.</span><span class="pln">addEventListener</span><span class="pun">(</span><span class="pln">type</span><span class="pun">,</span><span class="pln"> handle</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">);</span><br>5.  <span class="pln">        </span><span class="pun">}</span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ele</span><span class="pun">.</span><span class="pln">attachEvent</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>6.  <span class="pln">            ele</span><span class="pun">.</span><span class="pln">attachEvent</span><span class="pun">(</span><span class="str">‘on’</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> type</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><br>7.  <span class="pln">                handle</span><span class="pun">.</span><span class="pln">call</span><span class="pun">(</span><span class="pln">ele</span><span class="pun">);</span><br>8.  <span class="pln">            </span><span class="pun">});</span><br>9.  <span class="pln">        </span><span class="pun">}</span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><br>10.  <span class="pln">            ele</span><span class="pun">[</span><span class="str">‘on’</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> type</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> handle</span><span class="pun">;</span><br>11.  <span class="pln">        </span><span class="pun">}</span><br>12.  <span class="pln">    </span><span class="pun">}</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>这样事件绑定基本就完成了，但是还可以优化一下，在第二个IE的方法中我们用了一个匿名函数，这样这个函数就无法解除绑定了，因此可以优化成命名函数。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="pln">    </span><span class="kwd">function</span><span class="pln"> attachEvent</span><span class="pun">(</span><span class="pln">ele</span><span class="pun">,</span><span class="pln"> type</span><span class="pun">,</span><span class="pln"> handle</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>3.  <span class="pln">        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ele</span><span class="pun">.</span><span class="pln">addEventListener</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>4.  <span class="pln">            ele</span><span class="pun">.</span><span class="pln">addEventListener</span><span class="pun">(</span><span class="pln">type</span><span class="pun">,</span><span class="pln"> handle</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">);</span><br>5.  <span class="pln">        </span><span class="pun">}</span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ele</span><span class="pun">.</span><span class="pln">attachEvent</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>6.  <span class="pln">            ele</span><span class="pun">[</span><span class="str">‘temp’</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> type </span><span class="pun">+</span><span class="pln"> handle</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> handle</span><span class="pun">;</span><br>7.  <span class="pln">            ele</span><span class="pun">[</span><span class="pln">type </span><span class="pun">+</span><span class="pln"> handle</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><br>8.  <span class="pln">                ele</span><span class="pun">[</span><span class="str">‘temp’</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> type </span><span class="pun">+</span><span class="pln"> handle</span><span class="pun">].</span><span class="pln">call</span><span class="pun">(</span><span class="pln">ele</span><span class="pun">);</span><br>9.  <span class="pln">            </span><span class="pun">};</span><br>10.  <span class="pln">            ele</span><span class="pun">.</span><span class="pln">attachEvent</span><span class="pun">(</span><span class="str">‘on’</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> type</span><span class="pun">,</span><span class="pln"> ele</span><span class="pun">[</span><span class="pln">type </span><span class="pun">+</span><span class="pln"> handle</span><span class="pun">]);</span><br>11.  <span class="pln">        </span><span class="pun">}</span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><br>12.  <span class="pln">            ele</span><span class="pun">[</span><span class="str">‘on’</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> type</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> handle</span><span class="pun">;</span><br>13.  <span class="pln">        </span><span class="pun">}</span><br>14.  <span class="pln">    </span><span class="pun">}</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>这种写法应该是业内公认的事件绑定方式。这里专门处理了IE方法中的匿名函数问题，我们用元素自身的一个属性来保存了这个处理函数。</p>
<h3 id="解除事件处理程序"><a href="#解除事件处理程序" class="headerlink" title="解除事件处理程序"></a><span style="color: #ff0000;">解除事件处理程序</span></h3><p>1.句柄方式</p>
<p><strong><span style="color: #ff0000;">ele.onclick=null</span></strong></p>
<p>这样很简单的就可以解除绑定的事件处理函数了。</p>
<p>2.<strong><span style="color: #ff0000;">ele.removeEventListener(type, handle, false)</span></strong></p>
<p>针对的addEventListener的解除绑定。</p>
<p>但是这里要注意，只有命名函数才可以解除绑定，当绑定的函数是匿名函数的时候，是没有办法解除绑定的。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="pln">div</span><span class="pun">.</span><span class="pln">addEventListener</span><span class="pun">(</span><span class="str">‘click’</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">()｛</span><span class="pln">console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="str">‘a’</span><span class="pun">);｝,</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">);</span><br>3.  <span class="pln">div</span><span class="pun">.</span><span class="pln">removeEventListener</span><span class="pun">(</span><span class="str">‘click’</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">()｛</span><span class="pln">console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="str">‘a’</span><span class="pun">);｝,</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">);</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>这是没有办法解除绑定的，因为这是两个匿名函数。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">function</span><span class="pln"> test</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><br>3.  <span class="pln">      console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="str">‘a’</span><span class="pun">);</span><br>4.  <span class="pun">}</span><br>5.  <span class="pln">div</span><span class="pun">.</span><span class="pln">addEventListener</span><span class="pun">(</span><span class="str">‘click’</span><span class="pun">,</span><span class="pln"> test</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">);</span><br>6.  <span class="pln">div</span><span class="pun">.</span><span class="pln">removeEventListener</span><span class="pun">(</span><span class="str">‘click’</span><span class="pun">,</span><span class="pln"> test</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">);</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>必须改成这种方式才可以解除绑定。</p>
<p>3.<strong><span style="color: #ff0000;">ele.detachEvent(‘on’ + type, handle)</span></strong></p>
<p>针对IE的attachEvent的解除绑定。</p>
<p><span style="color: #ff0000;">也是同一个函数才可以解除绑定，匿名函数无法解除绑定</span>。</p>
<p>封装兼容性的解除绑定函数：</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="kwd">function</span><span class="pln"> remvoeEvent</span><span class="pun">(</span><span class="pln">ele</span><span class="pun">,</span><span class="pln"> type</span><span class="pun">,</span><span class="pln"> handle</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>3.  <span class="pln">      </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">ele</span><span class="pun">.</span><span class="pln">removeEventListener</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>4.  <span class="pln">            ele</span><span class="pun">.</span><span class="pln">removeEventListener</span><span class="pun">(</span><span class="pln">type</span><span class="pun">,</span><span class="pln"> handle</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">);</span><br>5.  <span class="pln">      </span><span class="pun">}</span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ele</span><span class="pun">.</span><span class="pln">detachEvent</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>6.  <span class="pln">            ele</span><span class="pun">.</span><span class="pln">detachEvent</span><span class="pun">(</span><span class="str">‘on’</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> type</span><span class="pun">,</span><span class="pln"> handle</span><span class="pun">);</span><br>7.  <span class="pln">      </span><span class="pun">}</span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><br>8.  <span class="pln">            ele</span><span class="pun">[</span><span class="str">‘on’</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> type</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">;</span><br>9.  <span class="pln">      </span><span class="pun">}</span><br>10.  <span class="pun">}</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>今天的事件只是就到这里哟~</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/01/02/JavaScriptSeventeen/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/02/JavaScriptSeventeen/" itemprop="url">Web前端的知识之旅哟——脚本化CSS</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-01-02T17:44:22+08:00">
                2018-01-02
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>这篇文章主要介绍几种查看css样式的方法。</p>
<h3 id="读写css属性"><a href="#读写css属性" class="headerlink" title="读写css属性"></a><span style="color: #ff0000;">读写css属性</span></h3><p>每一个dom元素都有一个属性<span style="color: #ff0000;">style</span>，dom.style里面存放的这个元素的<strong><span style="color: #ff0000;">行间样式</span></strong>，我们可以通过这个属性来读写元素的行间样式。</p>
<p>注意：</p>
<p>1.我们碰到float这样的关键字属性的时候，前面要加一个<span style="color: #ff0000;">css</span>前缀。</p>
<p><span style="color: #ff0000;">float—&gt;cssFloat</span></p>
<p>2.复合属性必须拆解</p>
<p>border: 1px solid red;</p>
<p>这种属性是<span style="color: #ff0000;">不允许出现</span>的，只能写border-width、border-color、border-style。</p>
<p>3.当css中的样式是用“-”连接起来的时候，我们要变成<span style="color: #ff0000;">小驼峰式</span>写法。</p>
<p>background-color —&gt; backgroundColor;</p>
<p>这个属性<span style="color: #ff0000;">只能读写行间样式</span>，我们<span style="color: #ff0000;">写在css的样式是不能获取</span>的，因此我们通过这个属性加样式的时候要<span style="color: #ff0000;">注意权重值问题</span>。</p>
<p>同时，我们在js中写样式只能往行间写，永远也写不到css文件里面。</p>
<h3 id="查询计算样式"><a href="#查询计算样式" class="headerlink" title="查询计算样式"></a><span style="color: #ff0000;">查询计算样式</span></h3><p>window上面有一个方法叫做<span style="color: #ff0000;">getComputedStyle</span>可以来获取元素的计算样式，也就是css样式。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">window</span><span class="pun">.</span><span class="pln">getComputedStyle</span><span class="pun">(</span><span class="pln">ele</span><span class="pun">.</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">);</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>这里的样式是<strong><span style="color: #ff0000;">取优先级最高的</span></strong>，不只是行间样式，所有的只要是表现出来的样式都可以获取出来。</p>
<p>同时，返回的计算样式的值都是<span style="color: #ff0000;">绝对值</span>，没有相对单位。</p>
<p>我们写的background-color: red会返回rgb(255,0,0)，em单位或者百分比的单位都会化成具体的像素值返回。</p>
<p>这个方法有两个参数，第一个参数是我们要获取的元素。</p>
<p>第二个参数是一个字符串，代表我们是否要获取这个元素上面的某一个伪元素，如果不的话，就填写null，否则就填写要获取的这个元素的哪一个伪元素。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-CSS prettyprinted" style=""><br>1.  <span class="pln">div</span><span class="pun">:</span><span class="pln">after</span><span class="pun">{</span><br>2.  <span class="pln">      width</span><span class="pun">:</span><span class="pln"> </span><span class="lit">100px</span><span class="pun">;</span><br>3.  <span class="pln">      height</span><span class="pun">;</span><span class="pln"> </span><span class="lit">100px</span><span class="pun">;</span><br>4.  <span class="pln">      background</span><span class="pun">-</span><span class="pln">color</span><span class="pun">:</span><span class="pln"> red</span><span class="pun">;</span><br>5.  <span class="pun">}</span><br>6.  <span class="pln">window</span><span class="pun">.</span><span class="pln">getComputedStyle</span><span class="pun">(</span><span class="pln">div</span><span class="pun">,</span><span class="pln"> </span><span class="str">‘after’</span><span class="pun">).</span><span class="pln">width</span><span class="pun">;</span><span class="pln"> </span><span class="com">// 100px</span></pre><div class="code-pretty-toolbar"><span class="title">CSS</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>但是很遗憾的是<span style="color: #ff0000;">IE8以及以下的版本不兼容</span>这个方法。</p>
<p>IE8有一个特殊的样式<span style="color: #ff0000;">currentStyle</span>。</p>
<p>dom.currentStyle也会返回一个样式表，和上面的基本一样，唯一的区别在于返回的计算样式的值不是经过转换的绝对值，而是我们写什么值就会返回什么值。</p>
<p>现在有了这些方法和属性，我们就可以封装一个兼容性的获取样式的函数了。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="kwd">function</span><span class="pln"> getStyle</span><span class="pun">(</span><span class="pln">obj</span><span class="pun">,</span><span class="pln"> prop</span><span class="pun">,</span><span class="pln"> fake</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>2.  <span class="pln">    </span><span class="kwd">var</span><span class="pln"> fake </span><span class="pun">=</span><span class="pln"> fake </span><span class="pun">||</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">;</span><br>3.  <span class="pln">    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">obj</span><span class="pun">.</span><span class="pln">currentStyle</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>4.  <span class="pln">        </span><span class="kwd">return</span><span class="pln"> obj</span><span class="pun">.</span><span class="pln">currentStyle</span><span class="pun">[</span><span class="pln">prop</span><span class="pun">];</span><br>5.  <span class="pln">    </span><span class="pun">}</span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><br>6.  <span class="pln">        </span><span class="kwd">return</span><span class="pln"> window</span><span class="pun">.</span><span class="pln">getComputedStyle</span><span class="pun">(</span><span class="pln">obj</span><span class="pun">,</span><span class="pln"> fake</span><span class="pun">)[</span><span class="pln">prop</span><span class="pun">];</span><br>7.  <span class="pln">    </span><span class="pun">}</span><br>8.  <span class="pun">}</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>• <span style="color: #ff0000;">脚本化样式表</span></p>
<p>在document上有一个属性叫做styleSheets，这个属性储存了一个html文档所有的css样式表的集合，我们可以来操作style标签，不过在实际中基本是用不到的，所以这里就不过多介绍了。</p>
<p>最后我们可以写一个<strong><span style="color: #ff0000;">让小方块运动的函数</span></strong>：</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-CSS/JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="pln">div</span><span class="com">#demo {</span><br>3.  <span class="pln">    width</span><span class="pun">:</span><span class="pln"> </span><span class="lit">100px</span><span class="pun">;</span><br>4.  <span class="pln">    height</span><span class="pun">:</span><span class="pln"> </span><span class="lit">100</span><span class="pun">;</span><br>5.  <span class="pln">    position</span><span class="pun">:</span><span class="pln"> absolute</span><span class="pun">;</span><br>6.  <span class="pln">    left</span><span class="pun">:</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><br>7.  <span class="pln">    top</span><span class="pun">:</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><br>8.  <span class="pun">}</span><br>9.  <span class="pln">&nbsp;</span><br>10.  <span class="pln">&nbsp;</span><br>11.  <span class="kwd">var</span><span class="pln"> div </span><span class="pun">=</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">getElementById</span><span class="pun">(</span><span class="str">‘demo’</span><span class="pun">);</span><br>12.  <span class="kwd">var</span><span class="pln"> timer </span><span class="pun">=</span><span class="pln"> window</span><span class="pun">.</span><span class="pln">setInterval</span><span class="pun">(</span><span class="kwd">function</span><span class="pln"> </span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><br>13.  <span class="pln">    div</span><span class="pun">.</span><span class="pln">style</span><span class="pun">.</span><span class="pln">left </span><span class="pun">=</span><span class="pln"> parseInt</span><span class="pun">(</span><span class="pln">getStyle</span><span class="pun">(</span><span class="pln">div</span><span class="pun">,</span><span class="pln"> </span><span class="str">‘left’</span><span class="pun">))</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="str">‘px’</span><span class="pun">;</span><br>14.  <span class="pln">    ifparseInt</span><span class="pun">((</span><span class="pln">getStyle</span><span class="pun">(</span><span class="pln">div</span><span class="pun">,</span><span class="pln"> </span><span class="str">‘left’</span><span class="pun">))</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">1000</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>15.  <span class="pln">           clearInterval</span><span class="pun">(</span><span class="pln">timer</span><span class="pun">);</span><br>16.  <span class="pln">    </span><span class="pun">}</span><br>17.  <span class="pun">},</span><span class="pln"> </span><span class="lit">10</span><span class="pun">);</span></pre><div class="code-pretty-toolbar"><span class="title">CSS/JS</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/01/02/JavaScriptSixteen/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/02/JavaScriptSixteen/" itemprop="url">Web前端的知识之旅哟——滚动条与元素尺寸</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-01-02T17:44:16+08:00">
                2018-01-02
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="查看滚动条的滚动距离"><a href="#查看滚动条的滚动距离" class="headerlink" title="查看滚动条的滚动距离"></a><span style="color: #ff0000;">查看滚动条的滚动距离</span></h3><p>js中有两套方法可以查看当前滚动条的滚动距离。</p>
<p>第一套是这样的：</p>
<p><span style="color: #ff0000;">window.pageXOffset/window.pageYOffset</span></p>
<p>这个方法可以查看滚动条的横轴和纵轴的滚动距离，但是很遗憾的是<span style="color: #ff0000;">IE8以及以下的版本不兼容</span>。</p>
<p>因此针对于IE，我们就需要有第二套方法：</p>
<p><span style="color: #ff0000;">document.body.scrollLeft/doucment.body.scrollTop</span></p>
<p><span style="color: #ff0000;">document.documentElement.scrollLeft/document.documentElement.scrollTop</span></p>
<p>虽然IE可以使用这两个方法，但是这两个方法不仅仅是IE才可以使用。</p>
<p>这里要说明的是，<span style="color: #ff0000;">这两种方法要一起使用</span>，因为浏览器的兼容性问题，有的浏览器是document.body有值，有的是document.documentElement有值，<span style="color: #ff0000;">但是所有的浏览器都只有一个有值，不会两个都有或者一个都没有</span>，而且这里的没有值不代表是null，而是0，因此我们使用的时候一般都是两个一起使用。</p>
<p>针对兼容性的问题，我们现在就可以封装一个函数，求滚动条滚动距离的方法。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="kwd">function</span><span class="pln"> getScrollOffset</span><span class="pun">(){</span><br>2.  <span class="pln">&nbsp; &nbsp; &nbsp; </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">window</span><span class="pun">.</span><span class="pln">pageXOffset</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>3.  <span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">{</span><br>4.  <span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x</span><span class="pun">:</span><span class="pln"> window</span><span class="pun">.</span><span class="pln">pageXOffset</span><span class="pun">,</span><br>5.  <span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; y</span><span class="pun">:</span><span class="pln"> window</span><span class="pun">.</span><span class="pln">pageYOffset</span><br>6.  <span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><br>7.  <span class="pln">&nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><br>8.  <span class="pln">&nbsp; &nbsp; &nbsp; </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">{</span><br>9.  <span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x</span><span class="pun">:</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">body</span><span class="pun">.</span><span class="pln">scollTop </span><span class="pun">+</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">documentElement</span><span class="pun">.</span><span class="pln">scrollTop</span><span class="pun">,</span><br>10.  <span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; y</span><span class="pun">:</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">body</span><span class="pun">.</span><span class="pln">scrollLeft </span><span class="pun">+</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">documentELement</span><span class="pun">.</span><span class="pln">scrollLeft</span><span class="pun">;</span><br>11.  <span class="pun">}</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>当浏览器不是IE的时候，可以直接使用window.pageXOffset和window.pageYOffset的方法，当没有这两个的时候，我们才需要来计算。</p>
<h3 id="查看视口的尺寸"><a href="#查看视口的尺寸" class="headerlink" title="查看视口的尺寸"></a><span style="color: #ff0000;">查看视口的尺寸</span></h3><p>视口就是我们的可视区，因为我们改变浏览器的大小的时候会改变可视区的大小，那么我们如何来查看当前浏览器的可视区大小？</p>
<p>这里我们依然有两套方法：</p>
<p>第一套是<span style="color: #ff0000;">window.innerHeight/window.innerWidth;</span></p>
<p>这个方法可以直接获取到当前可视区的宽高，但是依然很遗憾的是<span style="color: #ff0000;">IE8以及以下的版本不兼容</span>。</p>
<p>这个时候就需要第二套方法了：</p>
<p>在标准模式下，<span style="color: #ff0000;">doucment.documentElement.clientWidth/document.documentElement.clientHeight</span></p>
<p>在任何浏览器都兼容。</p>
<p>在怪异模式（混杂模式）下，</p>
<p><span style="color: #ff0000;">document.body.clientWidth/document.body.clientHeight</span></p>
<p>才能查看视口大小，而不能使用上面标准模式下的方法。</p>
<p>• 什么是怪异模式和标准模式呢？</p>
<p>浏览器的渲染模式有两种：<span style="color: #ff0000;">标准模式和怪异模式</span>。我们常用的是标准模式，怪异模式是防止浏览器升级版本过高对后面版本你的代码不兼容，让浏览器可以向后兼容其他低版本的代码的法规则，比如IE6的怪异模式下可以兼容IE5个IE4的语法。</p>
<p>• &nbsp;我们如何变成怪异模式呢？</p>
<p>其实很简单，只需要把我们html代码的第一行的<strong><span style="color: #ff0000;">&lt;!DOCTYPE HTML&gt;</span></strong>去掉就可以变成怪异模式了，而加上这一行代码就可以变成标准模式。</p>
<p>• 如何判断怪异模式还是标准模式？</p>
<p>document上中有一个方法叫做<span style="color: #ff0000;">compatMode</span>，当浏览器处于怪异模式的时候会返回字符串“<span style="color: #ff0000;">BackCompat</span>”，在标准模式下可以返回“<span style="color: #ff0000;">CSS1Compat</span>”，通过这个方法我们就可以判断了。</p>
<p>知道了什么是标准模式和怪异模式以及如何判断的情况下，我们就可以封装一个兼容性的函数，返回浏览器的视口大小。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="pln">&nbsp; </span><span class="kwd">function</span><span class="pln"> getViewportOffset </span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><br>3.  <span class="pln">&nbsp; &nbsp; &nbsp; </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">window</span><span class="pun">.</span><span class="pln">innerWidth</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>4.  <span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">{</span><br>5.  <span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; w</span><span class="pun">:</span><span class="pln"> window</span><span class="pun">.</span><span class="pln">innerWidth</span><span class="pun">,</span><br>6.  <span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; h</span><span class="pun">:</span><span class="pln"> window</span><span class="pun">.</span><span class="pln">innerHeight</span><br>7.  <span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><br>8.  <span class="pln">&nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><br>9.  <span class="pln">&nbsp; &nbsp; &nbsp; </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">document</span><span class="pun">.</span><span class="pln">compatMode </span><span class="pun">==</span><span class="pln"> </span><span class="str">‘CSS1Compat’</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>10.  <span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">{</span><br>11.  <span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; w</span><span class="pun">:</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">documentElement</span><span class="pun">.</span><span class="pln">clientWidth</span><span class="pun">,</span><br>12.  <span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; h</span><span class="pun">:</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">documentElement</span><span class="pun">.</span><span class="pln">clientHeight</span><br>13.  <span class="pln">&nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><br>14.  <span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">{</span><br>15.  <span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; w</span><span class="pun">:</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">body</span><span class="pun">.</span><span class="pln">clientWidth</span><span class="pun">,</span><br>16.  <span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; h</span><span class="pun">:</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">body</span><span class="pun">.</span><span class="pln">clientHeight</span><br>17.  <span class="pln">&nbsp; &nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><br>18.  <span class="pln">&nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><br>19.  <span class="pun">}</span><span class="pln">&nbsp; </span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>&nbsp;</p>
<h3 id="查看元素的几何尺寸"><a href="#查看元素的几何尺寸" class="headerlink" title="查看元素的几何尺寸"></a><span style="color: #ff0000;">查看元素的几何尺寸</span></h3><p><strong><span style="color: #ff0000;">domEle.getBoundingClientRect()</span></strong></p>
<p>在获取的dom元素上，有一个getBoundingClientRect方法，这个方法可以获取到元素的宽高和左上点的位置以及有下点的位置（width、height、top、left、right、bottom），注意这里的宽高是指除去了margin的盒子模型的宽高。</p>
<p>但是<span style="color: #ff0000;">老版本的IE浏览器没有实现width和height</span>，那么我们在老版本的IE计算宽高的时候就需要用<span style="color: #ff0000;">bottom-top</span>和<span style="color: #ff0000;">right-left</span>来计算宽高值了。</p>
<p>还有一点需要注意的是，这里的宽高也不是实时更新的，数据只是一个<span style="color: #ff0000;">副本</span>。</p>
<p>我们依然可以封装一个函数，可以返回元素的宽高。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="typ">Element</span><span class="pun">.</span><span class="pln">getElementOffset</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><br>3.  <span class="pln">&nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> objData </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">getBoundingClientRect</span><span class="pun">();</span><br>4.  <span class="pln">&nbsp; &nbsp; &nbsp; </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">objData</span><span class="pun">.</span><span class="pln">width</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>5.  <span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">{</span><br>6.  <span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; w</span><span class="pun">:</span><span class="pln"> objData</span><span class="pun">.</span><span class="pln">width</span><span class="pun">,</span><br>7.  <span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; h</span><span class="pun">:</span><span class="pln"> objData</span><span class="pun">.</span><span class="pln">height</span><br>8.  <span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><br>9.  <span class="pln">&nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><br>10.  <span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">{</span><br>11.  <span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; w</span><span class="pun">:</span><span class="pln"> objData</span><span class="pun">.</span><span class="pln">right </span><span class="pun">-</span><span class="pln"> objData</span><span class="pun">.</span><span class="pln">left</span><span class="pun">,</span><br>12.  <span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; h</span><span class="pun">:</span><span class="pln"> objData</span><span class="pun">.</span><span class="pln">bottom </span><span class="pun">-</span><span class="pln"> objData</span><span class="pun">.</span><span class="pln">top</span><br>13.  <span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><br>14.  <span class="pln">&nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><br>15.  <span class="pun">}</span><br>16.  <span class="pln">&nbsp;</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>&nbsp;</p>
<p><strong><span style="color: #ff0000;">滚动条滚动</span></strong></p>
<p>让滚动条滚动的方法有三个：<strong><span style="color: #ff0000;">scroll、scrollTo、scrollBy</span></strong>。</p>
<p>这三个方法都有两个参数，分别是x值和y值。前两个方法的作用一模一样，都是让滚动条滚动到（x，y）的位置，但是最后一个scrollBy有一些区别，它是<span style="color: #ff0000;">让滚动条相对于上一个位置滚动多少距离</span>。</p>
<p>我们可以简单的用这个方法来实现一个自动阅读的功能：</p>
<p><span style="color: #0000ff;">setInterval(function () {</span></p>
<p><span style="color: #0000ff;">&nbsp; &nbsp; &nbsp; scrollBy(0, 10);</span></p>
<p><span style="color: #0000ff;">},50);</span></p>
<p><strong><span style="color: #ff0000;">另一个查看元素尺寸的方法</span></strong></p>
<p><strong><span style="color: #ff0000;">dom.offsetWidth/dom.offsetHeight</span></strong></p>
<p>虽然前面有一个ele.getBoundingClientRect()方法，但是由于这个方法名字是在太长了，因此用的并不是非常多，相比较而言，这两个dom元素的属性用的更多一些。</p>
<p>这里获取的宽高值和上面的一样，都是除去margin后的盒子模型的宽高。</p>
<p><strong><span style="color: #ff0000;">查看元素的位置</span></strong></p>
<p>dom.offsetLeft/dom.offsetTop</p>
<p>这两个值分别是元素距离左侧和上侧的距离，这里的值是<span style="color: #ff0000;">相对于有定位的父级</span>而言的，如果没有有定位的父级的话，才是相对于文档的坐标。</p>
<p>那么现在就来了一个问题：如何找到有定位的父级呢？</p>
<p>domEle上面还有一个属性是offsetParent，这个属性可以查看到元素的有定位的父级，如果没有的话就会返回body，而body的offsetParent则是null。</p>
<p>我们利用上面的信息，可以来封装一个函数，求元素的相对于文档的坐标。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">&nbsp;</span><br>2.  <span class="typ">Element</span><span class="pun">.</span><span class="pln">prototype</span><span class="pun">.</span><span class="pln">getPosition </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(){</span><br>3.  <span class="pln">&nbsp; &nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(!</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">offsetParent</span><span class="pun">){</span><br>4.  <span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">{</span><br>5.  <span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="str">“w”</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">offsetLeft</span><span class="pun">,</span><br>6.  <span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="str">“h”</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">offsetTop</span><br>7.  <span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><br>8.  <span class="pln">&nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><br>9.  <span class="pln">&nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> width </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">offsetLeft</span><span class="pun">,</span><br>10.  <span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; height </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">offsetTop</span><span class="pun">,</span><br>11.  <span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ele </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">offsetParent</span><span class="pun">;</span><br>12.  <span class="pln">&nbsp; &nbsp; &nbsp; </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ele</span><span class="pun">.</span><span class="pln">offsetParent</span><span class="pun">){</span><br>13.  <span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; width </span><span class="pun">+=</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">offsetParent</span><span class="pun">.</span><span class="pln">offsetLeft</span><span class="pun">;</span><br>14.  <span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; height </span><span class="pun">+=</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">offsetParent</span><span class="pun">.</span><span class="pln">offsetTop</span><span class="pun">;</span><br>15.  <span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ele </span><span class="pun">=</span><span class="pln"> ele</span><span class="pun">.</span><span class="pln">offsetParent</span><span class="pun">;</span><br>16.  <span class="pln">&nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><br>17.  <span class="pln">&nbsp; &nbsp; &nbsp; </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">{</span><br>18.  <span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="str">“w”</span><span class="pun">:</span><span class="pln"> width</span><span class="pun">,</span><br>19.  <span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="str">“h”</span><span class="pun">:</span><span class="pln"> height</span><br>20.  <span class="pln">&nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><br>21.  <span class="pun">}</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>&nbsp;</p>
<p>那么今天要介绍的关于获取dom元素的尺寸以及滚动条相关的知识就这些哟~</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/01/02/JavaScriptFivteen/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/02/JavaScriptFivteen/" itemprop="url">Web前端的知识之旅哟——日期对象与定时器</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-01-02T16:54:34+08:00">
                2018-01-02
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="日期对象"><a href="#日期对象" class="headerlink" title="日期对象"></a><span style="color: #ff0000;">日期对象</span></h3><p>日期对象的方法在w3c上其实有介绍：</p>
<p><a href="http://www.w3school.com.cn/jsref/jsref_obj_date.asp" target="_blank" rel="noopener">http://www.w3school.com.cn/jsref/jsref_obj_date.asp</a></p>
<p>这里只是大体的提一下：</p>
<p>日期对象也是javascript的内置对象之一，我们可以直接使用。</p>
<p><span style="color: #0000ff;">var date = new Date();</span></p>
<p>在文档中我们也可以看到它的方法很多，但是常用的其实并没有那么多。</p>
<p>|<a href="http://www.w3school.com.cn/jsref/jsref_Date.asp" target="_blank" rel="noopener">Date()</a>|返回当日的日期和时间。|<br>|<a href="http://www.w3school.com.cn/jsref/jsref_getDate.asp" target="_blank" rel="noopener">getDate()</a>|从 Date 对象返回一个月中的某一天 (1 ~ 31)。|<br>|<a href="http://www.w3school.com.cn/jsref/jsref_getDay.asp" target="_blank" rel="noopener">getDay()</a>|从 Date 对象返回一周中的某一天 (0 ~ 6)。|<br>|<a href="http://www.w3school.com.cn/jsref/jsref_getMonth.asp" target="_blank" rel="noopener">getMonth()</a>|从 Date 对象返回月份 (0 ~ 11)。|<br>|<a href="http://www.w3school.com.cn/jsref/jsref_getFullYear.asp" target="_blank" rel="noopener">getFullYear()</a>|从 Date 对象以四位数字返回年份。|<br>|<a href="http://www.w3school.com.cn/jsref/jsref_getYear.asp" target="_blank" rel="noopener">getYear()</a>|<span class="deprecated">请使用 getFullYear() 方法代替。</span>|<br>|<a href="http://www.w3school.com.cn/jsref/jsref_getHours.asp" target="_blank" rel="noopener">getHours()</a>|返回 Date 对象的小时 (0 ~ 23)。|<br>|<a href="http://www.w3school.com.cn/jsref/jsref_getMinutes.asp" target="_blank" rel="noopener">getMinutes()</a>|返回 Date 对象的分钟 (0 ~ 59)。|<br>|<a href="http://www.w3school.com.cn/jsref/jsref_getSeconds.asp" target="_blank" rel="noopener">getSeconds()</a>|返回 Date 对象的秒数 (0 ~ 59)。|<br>|<a href="http://www.w3school.com.cn/jsref/jsref_getMilliseconds.asp" target="_blank" rel="noopener">getMilliseconds()</a>|返回 Date 对象的毫秒(0 ~ 999)。|<br>|<a href="http://www.w3school.com.cn/jsref/jsref_getTime.asp" target="_blank" rel="noopener">getTime()</a>|返回距1970年1月1日凌晨的毫秒数|<br>|<a href="http://www.w3school.com.cn/jsref/jsref_setDate.asp" target="_blank" rel="noopener">setDate()</a>|设置 Date 对象中月的某一天 (1 ~ 31)。|<br>|<a href="http://www.w3school.com.cn/jsref/jsref_setMonth.asp" target="_blank" rel="noopener">setMonth()</a>|设置 Date 对象中月份 (0 ~ 11)。|<br>|<a href="http://www.w3school.com.cn/jsref/jsref_setFullYear.asp" target="_blank" rel="noopener">setFullYear()</a>|设置 Date 对象中的年份（四位数字）。|<br>|<a href="http://www.w3school.com.cn/jsref/jsref_setYear.asp" target="_blank" rel="noopener">setYear()</a>|<span class="deprecated">请使用 setFullYear() 方法代替。</span>|<br>|<a href="http://www.w3school.com.cn/jsref/jsref_setHours.asp" target="_blank" rel="noopener">setHours()</a>|设置 Date 对象中的小时 (0 ~ 23)。|<br>|<a href="http://www.w3school.com.cn/jsref/jsref_setMinutes.asp" target="_blank" rel="noopener">setMinutes()</a>|设置 Date 对象中的分钟 (0 ~ 59)。|<br>|<a href="http://www.w3school.com.cn/jsref/jsref_setSeconds.asp" target="_blank" rel="noopener">setSeconds()</a>|设置 Date 对象中的秒钟 (0 ~ 59)。|<br>|<a href="http://www.w3school.com.cn/jsref/jsref_setMilliseconds.asp" target="_blank" rel="noopener">setMilliseconds()</a>|设置 Date 对象中的毫秒 (0 ~ 999)。|<br>|<a href="http://www.w3school.com.cn/jsref/jsref_setTime.asp" target="_blank" rel="noopener">setTime()</a>|以毫秒设置 Date 对象。|</p>
<p>这两组方法用的较多，其中值得注意的是，getMonths方法返回的是<span style="color: #ff0000;">0-11</span>，我们要获取当前月份的时候记得加一。</p>
<p>另外一点getTime方法返回从1970年1月1日到现在的毫秒数，这个时间我们称之为<span style="color: #ff0000;">时间戳</span>。</p>
<p>个人感觉日期对象并没有什么值得特别说明的地方…</p>
<h3 id="JS定时器"><a href="#JS定时器" class="headerlink" title="JS定时器"></a><span style="color: #ff0000;">JS定时器</span></h3><p>定时器是这篇文章的重点部分。</p>
<p>在javascript中，与定时器有关的方法是：</p>
<p><span style="color: #ff0000;">setInterval、clearInterval</span></p>
<p>以及</p>
<p><span style="color: #ff0000;">setTimeout、clearTimeout</span></p>
<p>这些方法都是定义在window对象上面的，因此我们写window.setInterval和解setInterval的意思是一样的，前面的window可以省略掉。</p>
<p>setInterval这个定时器的功能是每过一段时间，就把我们想要执行的函数放到js的<strong><span style="color: #ff0000;">执行队列</span></strong>中等待执行。因为执行队列不一定是空的，需要等执行队列中的所有任务都执行完之后才会执行我们的函数，因此这个函数执行的时间也会有细微的差别。</p>
<p>这个方法的语法是：</p>
<p>window.setInterval(function () {}, 1000);</p>
<p>第一个参数是我们要执行的函数，第二个参数是每过多长时间把函数放入执行队列。</p>
<p>这里要说明的是，第一个参数的那个函数，不能带有参数。其次，<strong><span style="color: #ff0000;">里面的this默认指向window</span></strong>，因为前面提到过，谁调用方法，方法里面的this就指向谁，setInterval其实前面省略了window，因此里面的this默认一定指向window，不论这个setInterval是否是一个对象的方法。</p>
<p>setInterval其实很消耗内存，这个定时器一旦执行，就不会终止，因此需要我们的内核一直监听这个函数。</p>
<p>这个时候我们就需要一个方法来清除定时器了：clearInterval。</p>
<p>定时器其实会返回一个标记，我们可以通过定时器的这个标记来清除掉相对应的定时器。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br><br>1.  <span class="kwd">var</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><br>2.  <span class="kwd">var</span><span class="pln"> timer </span><span class="pun">=</span><span class="pln"> setInterval</span><span class="pun">(</span><span class="kwd">function</span><span class="pln"> </span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><br>3.  <span class="pln">&nbsp; &nbsp; &nbsp; i</span><span class="pun">++;</span><br>4.  <span class="pln">&nbsp; &nbsp; &nbsp; </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">i </span><span class="pun">===</span><span class="pln"> </span><span class="lit">10</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>5.  <span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; clearInterval</span><span class="pun">(</span><span class="pln">timer</span><span class="pun">);</span><br>6.  <span class="pln">&nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><br>7.  <span class="pun">},</span><span class="pln"> </span><span class="lit">100</span><span class="pun">);</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>实际上，如果我们打印这个timer来看的话，它就是一个数字1，我们再开一个定时器，返回的就是2，也就是说，这个标记就是定时器的序号数，我们直接clearInterval(1);其实也可以清除掉第一个定时器，不过这里还是用标记来清除较好。</p>
<p>因此这里有一点需要特别强调：<strong><span style="color: #ff0000;">凡是写定时器，一定要清除定时器！</span></strong></p>
<p>还有一点需要注意的是，<span style="color: #ff0000;">定时器是先等待再执行</span>。</p>
<p>有时候我们只需要这个函数延迟一段时间执行，并不需要专门开启一个定时器，这个时候就需要用到setTimeout了。</p>
<p>setTimeout是延迟执行的意思，语法和用法和setInterval一样，只是这个方法只是把函数延迟一段时间之后执行一次而已。</p>
<p>同时它也有clearTimeout，当我们不想让这个函数执行了，提前把它clear掉就可以了。</p>
<p>其实setInterval和setTimeout的第一个参数不一定非要是一个函数，它也可以是一串字符型的js代码。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">setInterval</span><span class="pun">(</span><span class="str">“console.log(1);”</span><span class="pun">,</span><span class="pln"> </span><span class="lit">100</span><span class="pun">);</span><span class="pln">&nbsp; &nbsp; </span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>这段代码同样可以执行，定时器每100ms给我们打印一个1。</p>
<p>通过这个特性，我们不一定要把函数写在定时器里面，<span style="color: #ff0000;">大部分时间我们都是在外部把函数定义好了，然后直接把函数名传进去就可以了</span>。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="kwd">function</span><span class="pln"> test </span><span class="pun">()</span><span class="pln"> </span><span class="pun">{}</span><br>2.  <span class="pln">setInterval</span><span class="pun">(</span><span class="pln">test</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1000</span><span class="pun">);</span><span class="pln">&nbsp; &nbsp; </span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>那么这一次的知识点就这么多哟~</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/01/02/JavaScriptFourteen/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/02/JavaScriptFourteen/" itemprop="url">Web前端的知识之旅哟——DOM的基本操作练习代码</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-01-02T16:54:25+08:00">
                2018-01-02
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>1.<span style="color: #ff0000;">用DOM动态生成这样一个结构</span>：</p>
<p><span style="color: #0000ff;">&lt;div class=”example”&gt;</span></p>
<p><span style="color: #0000ff;">&nbsp; &nbsp; &nbsp; &lt;p class=”slogan”&gt;HelloWorld&lt;/p&gt;</span></p>
<p><span style="color: #0000ff;">&lt;/div&gt;</span></p>
<p>&nbsp;</p>
<p>我认为中规中矩的写法是这个样子的：</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="kwd">var</span><span class="pln"> div </span><span class="pun">=</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">createElement</span><span class="pun">(</span><span class="str">‘div’</span><span class="pun">),</span><br>2.  <span class="pln">p </span><span class="pun">=</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">createElement</span><span class="pun">(</span><span class="str">‘p’</span><span class="pun">),</span><br>3.  <span class="pln">text </span><span class="pun">=</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">create</span><span class="pun">(</span><span class="str">‘HelloWorld’</span><span class="pun">);</span><br>4.  <span class="pln">div</span><span class="pun">.</span><span class="pln">setAttribute</span><span class="pun">(</span><span class="str">‘class’</span><span class="pun">,</span><span class="pln"> </span><span class="str">‘example’</span><span class="pun">);</span><br>5.  <span class="pln">p</span><span class="pun">.</span><span class="pln">setAttribute</span><span class="pun">(</span><span class="str">‘class’</span><span class="pun">,</span><span class="pln"> </span><span class="str">‘slogan’</span><span class="pun">);</span><br>6.  <span class="pln">p</span><span class="pun">.</span><span class="pln">appendChild</span><span class="pun">(</span><span class="pln">text</span><span class="pun">);</span><br>7.  <span class="pln">div</span><span class="pun">.</span><span class="pln">appendChild</span><span class="pun">(</span><span class="pln">p</span><span class="pun">);</span><br>8.  <span class="pln">document</span><span class="pun">.</span><span class="pln">body</span><span class="pun">.</span><span class="pln">append</span><span class="pun">(</span><span class="pln">div</span><span class="pun">);</span><span class="pln">&nbsp; &nbsp; </span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>• 不过这里有点小提示，节点的<span style="color: #ff0000;">className属性</span>可以读写操作class。</p>
<p>因此这里我们为标签赋类名的值的时候可以不用setAttribute，可以直接用className。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">div</span><span class="pun">.</span><span class="pln">className </span><span class="pun">=</span><span class="pln"> </span><span class="str">‘example’</span><span class="pun">;</span><br>2.  <span class="pln">p</span><span class="pun">.</span><span class="pln">className </span><span class="pun">=</span><span class="pln"> </span><span class="str">‘slogan’</span><span class="pun">;</span><span class="pln">&nbsp; &nbsp; </span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>不过，还有一个最取巧的办法，那就是直接用innerHTML。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="pln">div</span><span class="pun">.</span><span class="pln">innerHTML </span><span class="pun">=</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">p </span><span class="kwd">class</span><span class="pun">=</span><span class="str">“slogan”</span><span class="pun">&gt;</span><span class="typ">HelloWorld</span><span class="pun">&lt;/</span><span class="pln">p</span><span class="pun">&gt;</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>2.<span style="color: #ff0000;">封装函数InsertAfter();功能类似insertBefore，直接在原型链上编程，可以忽略老版本的浏览器</span>。</p>
<p>代码：</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="typ">Element</span><span class="pun">.</span><span class="pln">insertAfter </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">targetNode</span><span class="pun">,</span><span class="pln"> afterNode</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>2.  <span class="pln">&nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> nextSib </span><span class="pun">=</span><span class="pln"> after</span><span class="pun">.</span><span class="pln">nextElementSibling</span><span class="pun">;</span><br>3.  <span class="pln">&nbsp; &nbsp; &nbsp; </span><span class="kwd">if</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">children</span><span class="pun">.</span><span class="pln">length </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> </span><span class="pun">!</span><span class="pln">nextSib</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br>4.  <span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">appendChild</span><span class="pun">(</span><span class="pln">targetNode</span><span class="pun">);</span><br>5.  <span class="pln">&nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><br>6.  <span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">insertBefore</span><span class="pun">(</span><span class="pln">targetNode</span><span class="pun">,</span><span class="pln"> nextSibling</span><span class="pun">);</span><br>7.  <span class="pln">&nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><br>8.  <span class="pun">}</span><span class="pln">&nbsp; &nbsp; </span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>这里是利用了原生的insertBefore方法，我们检测当只有一个子元素或者我们要找的元素就是最后一个，那么直接调用appendChild方法就可以，否则就找到要找的元素的下一个，然后把它的下一个元素当做insert的元素调用insertBefore方法就可以了。</p>
<p>3.<span style="color: #ff0000;">封装remove()函数，使得child.remove()可以销毁自身</span>。</p>
<p>看题目的要求就是要在原型链上编程。</p>
<p>代码：</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="typ">Element</span><span class="pun">.</span><span class="pln">prototype</span><span class="pun">.</span><span class="pln">remove </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><br>2.  <span class="pln">&nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> parent </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">parentNode</span><span class="pun">;</span><br>3.  <span class="pln">&nbsp; &nbsp; &nbsp; parent</span><span class="pun">.</span><span class="pln">removeChild</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">);</span><br>4.  <span class="pun">}</span><span class="pln"> &nbsp; </span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>

<p>这个问题的代码其实很简单，只要找到这个元素的父级，然后让父级删除掉这个元素就可以了。</p>
<p>4.<span style="color: #ff0000;">将目标节点内部的节点顺序逆序</span>。</p>
<p>eg:&nbsp;<span style="color: #0000ff;">&lt;div&gt;&lt;p&gt;&lt;/p&gt;&lt;a&gt;&lt;/a&gt;&lt;/div&gt; &nbsp; &nbsp;—&gt;</span></p>
<p><span style="color: #0000ff;">&lt;div&gt;&lt;a&gt;&lt;/a&gt;&lt;p&gt;&lt;/p&gt;&lt;/div&gt;</span></p>
<p>对于这个题目，我的做法是利用我们插入的元素如果是本身就存在的，那么就会剪切到新的位置上这个特性来做的。</p>
<p>代码：</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-JS prettyprinted" style=""><br>1.  <span class="typ">Element</span><span class="pun">.</span><span class="pln">prototype</span><span class="pun">.</span><span class="pln">reverseElement </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(){</span><br>2.  <span class="pln">&nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> len </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">childNodes</span><span class="pun">.</span><span class="pln">length</span><span class="pun">,</span><br>3.  <span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; child</span><span class="pun">,</span><br>4.  <span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; first </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">firstChild</span><span class="pun">;</span><br>5.  <span class="pln">&nbsp; &nbsp; &nbsp; </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">var</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> len </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++){</span><br>6.  <span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; child </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">lastChild</span><span class="pun">;</span><br>7.  <span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">insertBefore</span><span class="pun">(</span><span class="pln">child</span><span class="pun">,</span><span class="pln"> first</span><span class="pun">);</span><br>8.  <span class="pln">&nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><br>9.  <span class="pun">}</span></pre><div class="code-pretty-toolbar"><span class="title">JavaScript</span><a href="javascript:void(0" target="_blank" rel="noopener"></a>; “复制代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “查看纯文本代码”)<a href="javascript:void(0" target="_blank" rel="noopener"></a>; “返回代码高亮”)<span class="msg"></span></div></div>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">John Doe</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">33</span>
                  <span class="site-state-item-name">Artikel</span>
                </a>
              </div>
            

            

            

          </nav>

          

          <div class="links-of-author motion-element">
            
          </div>

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">John Doe</span>

  
</div>


  <div class="powered-by">Erstellt mit  <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.3</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
